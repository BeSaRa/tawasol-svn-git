<md-dialog id="distributionWorkflowDialog" class="dialog-extend" ng-attr-aria-label="{{lang.distribution_workflow}}">
    <div layout="column">
        <md-toolbar>
            <span class="p20">{{lang.distribution_workflow}}</span>
            <close-dialog-directive></close-dialog-directive>
        </md-toolbar>
        <md-content scroll-directive>
            <md-tabs md-dynamic-height>
                <!-- USERS -->
                <md-tab label="{{lang.users}}" ng-if="ctrl.showTab('users')">
                    <md-content scroll-directive layout-padding>
                        <form name="distribution_workflow_users_form" autocomplete="off">
                            <div layout="column">
                                <div layout="row" flex>
                                    <md-input-container flex>
                                        <md-select aria-label="select-user"
                                                   ng-model="ctrl.searchBy">
                                            <md-option md-truncate ng-value="criteria"
                                                       ng-repeat="criteria in ctrl.availableSearchCriteria track by $index">
                                                {{lang.get(criteria.value)}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="searchForUsers">{{lang.dwf_label_searchforusers}}</label>
                                        <input name="searchForUsers" id="searchForUsers"
                                               ng-change="ctrl.querySearchApplicationUsers()"
                                               ng-model="ctrl.usersSearchText">
                                    </md-input-container>
                                    <!--<div flex>-->
                                    <!--<md-button class="md-raised" ng-click="ctrl.openAddReceivedOUDialog($event)">-->
                                    <!--{{lang.add_organizations}}-->
                                    <!--</md-button>-->
                                    <!--</div>-->
                                    <span flex></span>
                                    <span flex></span>
                                    <span flex></span>
                                </div>
                                <md-card layout="column" class="card-overlay"
                                         ng-if="(ctrl.senderUser.length && ctrl.isReplyButton && !ctrl.isUserSearch)">
                                    <md-table-container flex scroll-directive style="max-height:200px !important;">
                                        <table md-table multiple="{{!ctrl._canNotSendToMultiUsers()}}" md-row-select
                                               ng-model="ctrl.selectedSenderUser">
                                            <thead md-head>
                                            <tr md-row>
                                                <th md-column md-order-by="arName">{{lang.arabic_name}}</th>
                                                <th md-column md-order-by="enName">{{lang.english_name}}</th>
                                                <th md-column>{{lang.organization_unit}}</th>
                                            </tr>
                                            </thead>
                                            <tbody md-body>
                                            <tr md-row md-select="sender"
                                                ng-disabled="ctrl.disableRow(sender)"
                                                ng-repeat="sender in ctrl.senderUser track by $index">
                                                <td md-cell>
                                                    {{sender.arName}}
                                                </td>
                                                <td md-cell>
                                                    {{sender.enName}}
                                                </td>
                                                <td md-cell>
                                                    {{sender.getTranslatedOUName()}}
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </md-table-container>
                                </md-card>
                                <md-card layout="column" class="card-overlay"
                                         ng-if="(ctrl.applicationUsers.length && !ctrl.isReplyButton) || ctrl.isUserSearch">
                                    <md-table-container flex scroll-directive style="max-height:200px !important;">
                                        <table md-table multiple="{{!ctrl._canNotSendToMultiUsers()}}" md-row-select
                                               ng-model="ctrl.selectedAppUsers">
                                            <thead md-head md-order="ctrl.gridAllUser.order">
                                            <tr md-row>
                                                <th md-column>
                                                    <md-button class="md-icon-button"
                                                               ng-click="ctrl.addRemoveBulkFavoriteUsers(ctrl.applicationUsers, $event)">
                                                        <md-icon class="star-yellow"
                                                                 md-svg-icon="{{ctrl.selectedAllFavoriteUsers ? 'star' :  'star-outline' }}"></md-icon>
                                                    </md-button>
                                                </th>
                                                <th md-column md-order-by="arName">{{lang.arabic_name}}</th>
                                                <th md-column md-order-by="enName">{{lang.english_name}}</th>
                                                <th md-column>{{lang.organization_unit}}</th>
                                            </tr>
                                            </thead>
                                            <tbody md-body>
                                            <!--ng-if="ctrl.notCurrentUser(applicationUser)"-->
                                            <tr md-row
                                                md-select="applicationUser"
                                                ng-disabled="ctrl.disableRow(applicationUser)"
                                                ng-repeat="applicationUser in ctrl.applicationUsers | limitTo: ctrl.gridAllUser.limit: ((ctrl.gridAllUser.page - 1) * ctrl.gridAllUser.limit) |orderBy:ctrl.gridAllUser.order track by $index">
                                                <td md-cell>
                                                    <md-button class="md-icon-button"
                                                               ng-click="ctrl.addRemoveSingleFavoriteUser(applicationUser, $event)">
                                                        <md-icon class="star-yellow"
                                                                 md-svg-icon="{{applicationUser.selected? 'star' :  'star-outline' }}"></md-icon>
                                                    </md-button>
                                                </td>
                                                <td md-cell>
                                                    {{applicationUser.arName}}
                                                </td>
                                                <td md-cell>
                                                    {{applicationUser.enName}}
                                                </td>
                                                <td md-cell>
                                                    {{applicationUser.getTranslatedOUName()}}
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <md-table-pagination
                                                md-label="{page: '{{lang.page}}', rowsPerPage: '{{lang.rows_per_page}}', of: '{{lang.count_of}}'}"
                                                md-limit-options="ctrl.gridAllUser.limitOptions"
                                                md-limit="ctrl.gridAllUser.limit" md-page="ctrl.gridAllUser.page"
                                                md-total="{{ctrl.applicationUsers.length}}" md-page-select>
                                        </md-table-pagination>
                                    </md-table-container>
                                </md-card>

                                <!--<distribution-workflow-input-directive
                                        model="ctrl.userDistributionWorkflow"
                                        user-actions="ctrl.userActions"
                                        form="distribution_workflow_users_form"
                                        enable-sms-notification="ctrl.enableSMSNotification"
                                        enable-email-notification="ctrl.enableEmailNotification"
                                        selected-grid-records="ctrl.selectedAppUsers"
                                        escalation-process-list="ctrl.escalationProcessList"
                                        call-back-method="ctrl.addUserToSendDistributionWorkflow"
                                        selected-reply-user="ctrl.selectedSenderUser">
                                </distribution-workflow-input-directive>-->

                                <div layout="row">
                                    <md-input-container flex>
                                        <label for="userSelectedAction">{{lang.dwf_label_selectaction}}</label>
                                        <md-select name="userSelectedAction" id="userSelectedAction" required
                                                   ng-model="ctrl.userDistributionWorkflow.action">
                                            <md-option ng-value="action"
                                                       ng-repeat="action in ctrl.userActions track by $index">
                                                {{action.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="distribution_workflow_users_form.userSelectedAction.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="userDueDate">{{lang.dwf_label_duedate}}</label>
                                        <md-datepicker id="userDueDate"
                                                       md-open-on-focus
                                                       md-min-date="ctrl.minDate"
                                                       ng-model="ctrl.userDistributionWorkflow.dueDate"
                                                       required
                                                       name="userDueDate"></md-datepicker>
                                        <div ng-messages="distribution_workflow_users_form.userDueDate.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <!--<md-input-container flex>-->
                                    <!--<label for="userEscalationProcess">{{lang.dwf_label_escalation}}</label>-->
                                    <!--<md-select name="userEscalationProcess" id="userEscalationProcess" required-->
                                    <!--ng-model="ctrl.userDistributionWorkflow.escalationProcess">-->
                                    <!--<md-option ng-value="escalationProcess"-->
                                    <!--ng-repeat="escalationProcess in ctrl.escalationProcessList track by $index">-->
                                    <!--{{lang.current==='en'? escalationProcess.enName-->
                                    <!--:escalationProcess.arName}}-->
                                    <!--</md-option>-->
                                    <!--</md-select>-->
                                    <!--<div ng-messages="distribution_workflow_users_form.userEscalationProcess.$error">-->
                                    <!--<div ng-message="required">{{lang.field_required}}</div>-->
                                    <!--</div>-->
                                    <!--</md-input-container>-->
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableSMSNotification"
                                                   ng-model="ctrl.userDistributionWorkflow.smsNotification"
                                                   layout-align="center center"
                                                   name="userSmsNotification" id="userSmsNotification"
                                                   aria-label="{{lang.sms}}">
                                            <span>{{lang.sms}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.userDistributionWorkflow.smsNotification)}}
                                        </md-switch>
                                    </div>
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableEmailNotification"
                                                   ng-model="ctrl.userDistributionWorkflow.emailNotification"
                                                   layout-align="center center"
                                                   name="userEmailNotification" id="userEmailNotification"
                                                   aria-label="{{lang.email_notification}}">
                                            <span>{{lang.email_notification}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.userDistributionWorkflow.emailNotification)}}
                                        </md-switch>
                                    </div>
                                    <div>
                                        <div flex>
                                            <md-button class="md-raised"
                                                       ng-disabled="distribution_workflow_users_form.$invalid || (ctrl.selectedAppUsers.length=== 0 && ctrl.selectedSenderUser.length===0) || ctrl.disableAdd()"
                                                       ng-click="ctrl.addUserToSendDistributionWorkflow(distribution_workflow_users_form)">
                                                {{lang.add}}
                                            </md-button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </md-content>
                </md-tab>
                <!-- Favorite Users -->
                <md-tab label="{{lang.favourite_users}}" ng-if="ctrl.showTab('favourite_users')">
                    <md-content scroll-directive>
                        <form name="favoriteUsersOUForm" autocomplete="off">
                            <div layout="column" class="p20">
                                <md-tabs md-dynamic-height>
                                    <!-- Users Tab -->
                                    <md-tab label="{{lang.users}}">
                                        <md-card layout="column" class="card-overlay">
                                            <md-table-container flex scroll-directive
                                                                style="max-height:200px !important;">
                                                <table md-table multiple="{{!ctrl._canNotSendToMultiUsers()}}"
                                                       md-row-select
                                                       ng-model="ctrl.selectedFavoriteUsers">
                                                    <thead md-head md-order="ctrl.gridFavoriteUser.order">
                                                    <tr md-row>
                                                        <th md-column>
                                                            <md-button class="md-icon-button"
                                                                       ng-click="ctrl.removeBulkUserFromFavoriteTab($event)">
                                                                <md-icon class="star-yellow"
                                                                         md-svg-icon="{{ctrl.allFavoriteUsers.length===0 ? 'star-outline': 'star'}}"></md-icon>
                                                            </md-button>
                                                        </th>
                                                        <th md-column md-order-by="arName">{{lang.arabic_name}}</th>
                                                        <th md-column md-order-by="enName">{{lang.english_name}}</th>
                                                        <th md-column>{{lang.organization_unit}}</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody md-body>
                                                    <tr md-row md-select="favoriteUser"
                                                        ng-if="ctrl.notCurrentUser(favoriteUser)"
                                                        ng-disabled="ctrl.disableRow(favoriteUser)"
                                                        ng-repeat="favoriteUser in ctrl.allFavoriteUsers | limitTo: ctrl.gridFavoriteUser.limit: ((ctrl.gridFavoriteUser.page - 1) * ctrl.gridFavoriteUser.limit) |orderBy:ctrl.gridFavoriteUser.order track by $index">
                                                        <td md-cell>
                                                            <md-button class="md-icon-button"
                                                                       ng-click="ctrl.removeSingleFavoriteUser(favoriteUser, $event)">
                                                                <md-icon class="star-yellow"
                                                                         md-svg-icon="star"></md-icon>
                                                            </md-button>
                                                        </td>
                                                        <td md-cell>
                                                            {{favoriteUser.arName}}
                                                        </td>
                                                        <td md-cell>
                                                            {{favoriteUser.enName}}
                                                        </td>
                                                        <td md-cell>
                                                            {{lang.current==='en'? favoriteUser.ouEnName
                                                            :favoriteUser.ouArName}}
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                                <md-table-pagination
                                                        md-label="{page: '{{lang.page}}', rowsPerPage: '{{lang.rows_per_page}}', of: '{{lang.count_of}}'}"
                                                        md-limit-options="ctrl.gridFavoriteUser.limitOptions"
                                                        md-limit="ctrl.gridFavoriteUser.limit"
                                                        md-page="ctrl.gridFavoriteUser.page"
                                                        md-total="{{ctrl.allFavoriteUsers.length}}" md-page-select>
                                                </md-table-pagination>
                                            </md-table-container>
                                        </md-card>
                                    </md-tab>
                                    <!-- Organizations Tab -->
                                    <md-tab label="{{lang.organizations}}">
                                        <md-card layout="column" class="card-overlay">
                                            <md-table-container flex scroll-directive
                                                                style="max-height:200px !important;">
                                                <table md-table multiple="{{!ctrl._canNotSendToMultiUsers()}}"
                                                       md-row-select
                                                       ng-model="ctrl.selectedFavoriteOUs">
                                                    <thead md-head md-order="ctrl.gridFavoriteOU.order">
                                                    <tr md-row>
                                                        <th md-column>
                                                            <md-button class="md-icon-button"
                                                                       ng-click="ctrl.addRemoveBulkFavoriteOUs(ctrl.allFavoriteOUs, true, $event)">
                                                                <md-icon class="star-yellow"
                                                                         md-svg-icon="{{ctrl.allFavoriteOUs.length===0 ? 'star-outline': 'star'}}"></md-icon>
                                                            </md-button>
                                                        </th>
                                                        <th md-column md-order-by="ouArName">{{lang.arabic_name}}</th>
                                                        <th md-column md-order-by="ouEnName">{{lang.english_name}}</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody md-body>
                                                    <tr md-row md-select="favoriteOU"
                                                        ng-repeat="favoriteOU in ctrl.allFavoriteOUs | limitTo: ctrl.gridFavoriteOU.limit: ((ctrl.gridFavoriteOU.page - 1) * ctrl.gridFavoriteOU.limit) |orderBy:ctrl.gridFavoriteOU.order track by $index">
                                                        <td md-cell>
                                                            <md-button class="md-icon-button"
                                                                       ng-click="ctrl.addRemoveSingleFavoriteOU(favoriteOU, $event)">
                                                                <md-icon class="star-yellow"
                                                                         md-svg-icon="star"></md-icon>
                                                            </md-button>
                                                        </td>
                                                        <td md-cell>
                                                            {{favoriteOU.ouArName}}
                                                        </td>
                                                        <td md-cell>
                                                            {{favoriteOU.ouEnName}}
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                                <md-table-pagination
                                                        md-label="{page: '{{lang.page}}', rowsPerPage: '{{lang.rows_per_page}}', of: '{{lang.count_of}}'}"
                                                        md-limit-options="ctrl.gridFavoriteOU.limitOptions"
                                                        md-limit="ctrl.gridFavoriteOU.limit"
                                                        md-page="ctrl.gridFavoriteOU.page"
                                                        md-total="{{ctrl.allFavoriteOUs.length}}" md-page-select>
                                                </md-table-pagination>
                                            </md-table-container>
                                        </md-card>
                                    </md-tab>
                                </md-tabs>
                                <div layout="row" flex>
                                    <md-input-container flex>
                                        <label for="favoriteUserOUSelectedAction">{{lang.dwf_label_selectaction}}</label>
                                        <md-select name="favoriteUserOUSelectedAction"
                                                   id="favoriteUserOUSelectedAction"
                                                   required
                                                   ng-model="ctrl.favoriteUserOUDistributionWorkflow.action">
                                            <md-option ng-value="action"
                                                       ng-repeat="action in ctrl.userActions track by $index">
                                                {{action.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="favoriteUsersOUForm.favoriteUserOUSelectedAction.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="favoriteUserOUDueDate">{{lang.dwf_label_duedate}}</label>
                                        <md-datepicker id="favoriteUserOUDueDate"
                                                       md-open-on-focus
                                                       md-min-date="ctrl.minDate"
                                                       ng-model="ctrl.favoriteUserOUDistributionWorkflow.dueDate"
                                                       required
                                                       name="favoriteUserOUDueDate"></md-datepicker>
                                        <div ng-messages="favoriteUsersOUForm.favoriteUserOUDueDate.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="favoriteUserOUEscalationProcess">{{lang.dwf_label_escalation}}</label>
                                        <md-select name="favoriteUserOUEscalationProcess"
                                                   id="favoriteUserOUEscalationProcess"
                                                   required
                                                   ng-model="ctrl.favoriteUserOUDistributionWorkflow.escalationProcess">
                                            <md-option ng-value="escalationProcess"
                                                       ng-repeat="escalationProcess in ctrl.escalationProcessList track by $index">
                                                {{lang.current==='en'? escalationProcess.enName
                                                :escalationProcess.arName}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="favoriteUsersOUForm.favoriteUserOUEscalationProcess.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <div flex layout-align="center center">
                                        <md-switch ng-disabled="!ctrl.enableSMSNotification"
                                                   ng-model="ctrl.favoriteUserOUDistributionWorkflow.smsNotification"
                                                   name="favoriteUserOUSmsNotification"
                                                   id="favoriteUserOUSmsNotification"
                                                   layout-align="center center"
                                                   aria-label="{{lang.sms}}">
                                            <span>{{lang.sms}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.favoriteUserOUDistributionWorkflow.smsNotification)}}
                                        </md-switch>
                                    </div>
                                    <div flex layout-align="center center">
                                        <md-switch ng-disabled="!ctrl.enableEmailNotification"
                                                   ng-model="ctrl.favoriteUserOUDistributionWorkflow.emailNotification"
                                                   name="favoriteUserOUEmailNotification"
                                                   id="favoriteUserOUEmailNotification"
                                                   layout-align="center center"
                                                   aria-label="{{lang.email_notification}}">
                                            <span>{{lang.email_notification}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.favoriteUserOUDistributionWorkflow.emailNotification)}}
                                        </md-switch>
                                    </div>
                                    <div>
                                        <div flex>
                                            <md-button class="md-raised"
                                                       ng-disabled="favoriteUsersOUForm.$invalid || (ctrl.selectedFavoriteUsers.length=== 0 && ctrl.selectedFavoriteOUs.length=== 0) || ctrl.disableAdd()"
                                                       ng-click="ctrl.addFavoriteUsersToSendDistributionWorkflow(favoriteUsersOUForm)">
                                                {{lang.add}}
                                            </md-button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </md-content>
                </md-tab>
                <!-- Managers -->
                <md-tab label="{{lang.managers}}" ng-if="ctrl.showTab('managers')">
                    <md-content scroll-directive>
                        <form name="distribution_workflow_managers_form" autocomplete="off">
                            <div layout="column" class="p20">
                                <div layout="row" flex>
                                    <md-input-container flex>
                                        <label>{{lang.organizations}}</label>
                                        <md-select ng-model-options="{trackBy: '$value.id'}"
                                                   ng-change="ctrl.getManagersForOU()"
                                                   name="parent" ng-model="ctrl.organizationsManager">
                                            <md-option md-truncate ng-value="organization"
                                                       ng-repeat="organization in ctrl.organizations track by $index">
                                                {{organization.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>

                                    <span flex></span>
                                    <span flex></span>
                                </div>
                                <md-card layout="column" class="card-overlay" ng-if="ctrl.allManagers.length">
                                    <md-table-container flex scroll-directive style="max-height:200px !important;">
                                        <table md-table multiple="{{!ctrl._canNotSendToMultiUsers()}}" md-row-select
                                               ng-model="ctrl.selectedManagers">
                                            <thead md-head md-order="ctrl.gridAllManager.order">
                                            <tr md-row>
                                                <th md-column>
                                                    <md-button class="md-icon-button"
                                                               ng-click="ctrl.addRemoveBulkFavoriteManagers()">
                                                        <md-icon class="star-yellow"
                                                                 md-svg-icon="{{ctrl.selectedAllFavoriteManagers ? 'star' :  'star-outline' }}"></md-icon>
                                                    </md-button>
                                                </th>
                                                <th md-column md-order-by="arName">{{lang.arabic_name}}</th>
                                                <th md-column md-order-by="enName">{{lang.english_name}}</th>
                                                <th md-column>{{lang.organization_unit}}</th>
                                            </tr>
                                            </thead>
                                            <tbody md-body>
                                            <tr md-row md-select="manager"
                                                ng-disabled="ctrl.disableRow(manager)"
                                                ng-repeat="manager in ctrl.allManagers | limitTo: ctrl.gridAllManager.limit: ((ctrl.gridAllManager.page - 1) * ctrl.gridAllManager.limit) |orderBy:ctrl.gridAllManager.order track by $index">
                                                <td md-cell>
                                                    <md-button class="md-icon-button"
                                                               ng-click="ctrl.addRemoveSingleFavoriteManager(manager, $event)">
                                                        <md-icon class="star-yellow"
                                                                 md-svg-icon="{{manager.selected? 'star' :  'star-outline' }}"></md-icon>
                                                    </md-button>
                                                </td>
                                                <td md-cell>
                                                    {{manager.arName}}
                                                </td>
                                                <td md-cell>
                                                    {{manager.enName}}
                                                </td>
                                                <td md-cell>
                                                    {{manager.getTranslatedOUName()}}
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <md-table-pagination
                                                md-label="{page: '{{lang.page}}', rowsPerPage: '{{lang.rows_per_page}}', of: '{{lang.count_of}}'}"
                                                md-limit-options="ctrl.gridAllManager.limitOptions"
                                                md-limit="ctrl.gridAllManager.limit" md-page="ctrl.gridAllManager.page"
                                                md-total="{{ctrl.allManagers.length}}" md-page-select>
                                        </md-table-pagination>
                                    </md-table-container>
                                </md-card>
                                <!--<distribution-workflow-input-directive
                                        model="ctrl.managerDistributionWorkflow"
                                        user-actions="ctrl.userActions"
                                        form="distribution_workflow_managers_form"
                                        enable-sms-notification="ctrl.enableSMSNotification"
                                        enable-email-notification="ctrl.enableEmailNotification"
                                        selected-grid-records="ctrl.selectedManagers"
                                        escalation-process-list="ctrl.escalationProcessList"
                                        call-back-method="ctrl.addManagersToSendDistributionWorkflow"
                                        selected-reply-user="ctrl.selectedSenderUser"
                                ></distribution-workflow-input-directive>-->
                                <div layout="row" flex>
                                    <md-input-container flex>
                                        <label for="managerSelectedAction">{{lang.dwf_label_selectaction}}</label>
                                        <md-select name="managerSelectedAction" id="managerSelectedAction" required
                                                   ng-model="ctrl.managerDistributionWorkflow.action">
                                            <md-option ng-value="action"
                                                       ng-repeat="action in ctrl.userActions track by $index">
                                                {{action.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="distribution_workflow_managers_form.managerSelectedAction.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="managerDueDate">{{lang.dwf_label_duedate}}</label>
                                        <md-datepicker id="managerDueDate"
                                                       md-open-on-focus
                                                       md-min-date="ctrl.minDate"
                                                       ng-model="ctrl.managerDistributionWorkflow.dueDate" required
                                                       name="managerDueDate"></md-datepicker>
                                        <div ng-messages="distribution_workflow_managers_form.managerDueDate.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="managerEscalationProcess">{{lang.dwf_label_escalation}}</label>
                                        <md-select name="managerEscalationProcess" id="managerEscalationProcess"
                                                   required
                                                   ng-model="ctrl.managerDistributionWorkflow.escalationProcess">
                                            <md-option ng-value="escalationProcess"
                                                       ng-repeat="escalationProcess in ctrl.escalationProcessList track by $index">
                                                {{lang.current==='en'? escalationProcess.enName
                                                :escalationProcess.arName}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="distribution_workflow_managers_form.managerEscalationProcess.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableSMSNotification"
                                                   ng-model="ctrl.managerDistributionWorkflow.smsNotification"
                                                   layout-align="center center"
                                                   name="managerSmsNotification" id="managerSmsNotification"
                                                   aria-label="{{lang.sms}}">
                                            <span>{{lang.sms}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.managerDistributionWorkflow.smsNotification)}}
                                        </md-switch>
                                    </div>
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableEmailNotification"
                                                   ng-model="ctrl.managerDistributionWorkflow.emailNotification"
                                                   name="managerEmailNotification" id="managerEmailNotification"
                                                   layout-align="center center"
                                                   aria-label="{{lang.email_notification}}">
                                            <span>{{lang.email_notification}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.managerDistributionWorkflow.emailNotification)}}
                                        </md-switch>
                                    </div>
                                    <div>
                                        <div flex>
                                            <md-button class="md-raised"
                                                       ng-disabled="distribution_workflow_managers_form.$invalid || ctrl.selectedManagers.length=== 0 || ctrl.disableAdd()"
                                                       ng-click="ctrl.addManagersToSendDistributionWorkflow(distribution_workflow_managers_form)">
                                                {{lang.add}}
                                            </md-button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </md-content>
                </md-tab>
                <!-- Organization Units -->
                <md-tab label="{{lang.organization_units}}" ng-if="ctrl.showTab('organization_units')">
                    <md-content scroll-directive>
                        <form name="distribution_workflow_OU_form" autocomplete="off">
                            <div layout="column" class="p20">
                                <div layout="row" flex>
                                    <md-input-container flex>
                                        <md-select aria-label="select-ou"
                                                   ng-model="ctrl.ouSearchBy">
                                            <md-option md-truncate ng-value="criteria"
                                                       ng-repeat="criteria in ctrl.availableSearchCriteriaOU track by $index">
                                                {{lang.get(criteria.value)}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="searchForOU">{{lang.search}} {{lang.organization_units}}</label>
                                        <input name="searchForOU" id="searchForOU"
                                               ng-change="ctrl.querySearchOrganizationGroup()"
                                               ng-model="ctrl.ouSearchText">
                                    </md-input-container>
                                    <span flex></span>
                                    <span flex></span>
                                    <span flex></span>
                                </div>
                                <md-card layout="column" class="card-overlay" ng-if="ctrl.allOUGroups.length">
                                    <md-table-container flex scroll-directive style="max-height:200px !important;">
                                        <table md-table multiple="{{!ctrl._canNotSendToMultiUsers()}}" md-row-select
                                               ng-model="ctrl.selectedOUGroups">
                                            <thead md-head md-order="ctrl.gridOUGroup.order">
                                            <tr md-row>
                                                <th md-column>
                                                    <md-button class="md-icon-button"
                                                               ng-click="ctrl.addRemoveBulkFavoriteOUs(ctrl.allOUGroups, false, $event)">
                                                        <md-icon class="star-yellow"
                                                                 md-svg-icon="{{ctrl.selectedAllFavoriteOUs ? 'star' :  'star-outline' }}"></md-icon>
                                                    </md-button>
                                                </th>
                                                <th md-column md-order-by="ouArName">{{lang.arabic_name}}</th>
                                                <th md-column md-order-by="ouEnName">{{lang.english_name}}</th>
                                            </tr>
                                            </thead>
                                            <tbody md-body>
                                            <tr md-row md-select="ouGroup"
                                                ng-repeat="ouGroup in ctrl.allOUGroups | limitTo: ctrl.gridOUGroup.limit: ((ctrl.gridOUGroup.page - 1) * ctrl.gridOUGroup.limit) |orderBy:ctrl.gridOUGroup.order track by $index">
                                                <td md-cell>
                                                    <md-button class="md-icon-button"
                                                               ng-click="ctrl.addRemoveSingleFavoriteOU(ouGroup, $event)">
                                                        <md-icon class="star-yellow"
                                                                 md-svg-icon="{{ouGroup.selected? 'star' :  'star-outline' }}"></md-icon>
                                                    </md-button>
                                                </td>
                                                <td md-cell>
                                                    {{ouGroup.ouArName}}
                                                </td>
                                                <td md-cell>
                                                    {{ouGroup.ouEnName}}
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <md-table-pagination
                                                md-label="{page: '{{lang.page}}', rowsPerPage: '{{lang.rows_per_page}}', of: '{{lang.count_of}}'}"
                                                md-limit-options="ctrl.gridOUGroup.limitOptions"
                                                md-limit="ctrl.gridOUGroup.limit" md-page="ctrl.gridOUGroup.page"
                                                md-total="{{ctrl.allOUGroups.length}}" md-page-select>
                                        </md-table-pagination>
                                    </md-table-container>
                                </md-card>
                                <div layout="row" flex>
                                    <md-input-container flex>
                                        <label for="ouGroupSelectedAction">{{lang.dwf_label_selectaction}}</label>
                                        <md-select name="ouGroupSelectedAction" id="ouGroupSelectedAction"
                                                   required ng-model="ctrl.mainOUDistributionWorkflow.action">
                                            <md-option ng-value="action"
                                                       ng-repeat="action in ctrl.userActions track by $index">
                                                {{action.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="distribution_workflow_OU_form.ouGroupSelectedAction.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="ouGroupDueDate">{{lang.dwf_label_duedate}}</label>
                                        <md-datepicker id="ouGroupDueDate"
                                                       md-open-on-focus
                                                       md-min-date="ctrl.minDate"
                                                       ng-model="ctrl.mainOUDistributionWorkflow.dueDate"
                                                       required name="ouGroupDueDate"></md-datepicker>
                                        <div ng-messages="distribution_workflow_OU_form.ouGroupDueDate.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="ouGroupEscalationProcess">{{lang.dwf_label_escalation}}</label>
                                        <md-select name="ouGroupEscalationProcess"
                                                   id="ouGroupEscalationProcess" required
                                                   ng-model="ctrl.mainOUDistributionWorkflow.escalationProcess">
                                            <md-option ng-value="escalationProcess"
                                                       ng-repeat="escalationProcess in ctrl.escalationProcessList track by $index">
                                                {{lang.current==='en'? escalationProcess.enName
                                                :escalationProcess.arName}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="distribution_workflow_OU_form.ouGroupEscalationProcess.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableSMSNotification"
                                                   ng-model="ctrl.mainOUDistributionWorkflow.smsNotification"
                                                   layout-align="center center"
                                                   name="ouGroupSmsNotification"
                                                   id="ouGroupSmsNotification"
                                                   aria-label="{{lang.sms}}">
                                            <span>{{lang.sms}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.mainOUDistributionWorkflow.smsNotification)}}
                                        </md-switch>
                                    </div>
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableEmailNotification"
                                                   ng-model="ctrl.mainOUDistributionWorkflow.emailNotification"
                                                   name="ouGroupEmailNotification"
                                                   id="ouGroupEmailNotification"
                                                   layout-align="center center"
                                                   aria-label="{{lang.email_notification}}">
                                            <span>{{lang.email_notification}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.mainOUDistributionWorkflow.emailNotification)}}
                                        </md-switch>
                                    </div>
                                    <div>
                                        <div flex>
                                            <md-button class="md-raised"
                                                       ng-click="ctrl.addOUGroupsToSendDistributionWorkflow(distribution_workflow_OU_form)"
                                                       ng-disabled="distribution_workflow_OU_form.$invalid || ctrl.selectedOUGroups.length=== 0 || ctrl.disableAdd()"
                                            >
                                                {{lang.add}}
                                            </md-button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </md-content>
                </md-tab>
                <!-- My Workflow Groups -->
                <md-tab label="{{lang.my_workflow_groups}}" ng-if="ctrl.showTab('my_workflow_groups')">
                    <md-content scroll-directive>
                        <form name="workflowGroups_form" autocomplete="off">
                            <div layout="column" class="p20">
                                <div layout="row" layout-align="start center" flex>
                                    <md-input-container flex>
                                        <label for="selectWorkflowGroup">{{lang.workflow_groups}}</label>
                                        <md-select ng-model-options="{trackBy: '$value.id'}"
                                                   aria-label="select-workflow-group" id="selectWorkflowGroup"
                                                   ng-change="ctrl.loadWorkflowGroupMembers(ctrl.selectWorkflowGroup)"
                                                   ng-model="ctrl.selectWorkflowGroup">
                                            <md-option md-truncate ng-value="workflowGroup"
                                                       ng-repeat="workflowGroup in ctrl.workflowGroups track by $index">
                                                {{lang.current==='en'? workflowGroup.enName :workflowGroup.arName}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                    <md-button ng-click="ctrl.openAddWorkflowGroupDialog($event)" class="md-icon-button"
                                               tooltip="{{lang.add}}">
                                        <md-icon md-svg-icon="plus"></md-icon>
                                    </md-button>
                                    <span flex></span>
                                    <span flex></span>
                                    <span flex></span>
                                </div>
                                <md-card layout="column" class="card-overlay"
                                         ng-if="ctrl.allWorkflowGroupMembers.length">
                                    <md-table-container flex scroll-directive style="max-height:200px !important;">
                                        <table md-table multiple="{{!ctrl._canNotSendToMultiUsers()}}" md-row-select
                                               ng-model="ctrl.selectedWorkflowMembers">
                                            <thead md-head md-order="ctrl.gridWorkflowGroupMember.order">
                                            <tr md-row>
                                                <th md-column md-order-by="arName">{{lang.arabic_name}}</th>
                                                <th md-column md-order-by="enName">{{lang.english_name}}</th>
                                                <th md-column>{{lang.organization_unit}}</th>
                                            </tr>
                                            </thead>
                                            <tbody md-body>
                                            <tr md-row md-select="workflowGroupMember"
                                                ng-disabled="ctrl.disableRow(workflowGroupMember)"
                                                ng-repeat="workflowGroupMember in ctrl.allWorkflowGroupMembers | limitTo: ctrl.gridWorkflowGroupMember.limit: ((ctrl.gridWorkflowGroupMember.page - 1) * ctrl.gridWorkflowGroupMember.limit) |orderBy:ctrl.gridWorkflowGroupMember.order track by $index">
                                                <td md-cell>
                                                    {{workflowGroupMember.arName}}
                                                </td>
                                                <td md-cell>
                                                    {{workflowGroupMember.enName}}
                                                </td>
                                                <td md-cell>
                                                    {{workflowGroupMember.getTranslatedOUName()}}
                                                    <!--{{lang.current==='en'? workflowGroupMember.ouEnName
                                                    :workflowGroupMember.ouArName}}-->
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <md-table-pagination
                                                md-label="{page: '{{lang.page}}', rowsPerPage: '{{lang.rows_per_page}}', of: '{{lang.count_of}}'}"
                                                md-limit-options="ctrl.gridWorkflowGroupMember.limitOptions"
                                                md-limit="ctrl.gridWorkflowGroupMember.limit"
                                                md-page="ctrl.gridWorkflowGroupMember.page"
                                                md-total="{{ctrl.allWorkflowGroupMembers.length}}" md-page-select>
                                        </md-table-pagination>
                                    </md-table-container>
                                </md-card>
                                <div layout="row" flex>
                                    <md-input-container flex>
                                        <label for="wgGroupMemberSelectedAction">{{lang.dwf_label_selectaction}}</label>
                                        <md-select name="wgGroupMemberSelectedAction" id="wgGroupMemberSelectedAction"
                                                   required
                                                   ng-model="ctrl.workflowGroupDistributionWorkflow.action">
                                            <md-option ng-value="action"
                                                       ng-repeat="action in ctrl.userActions track by $index">
                                                {{action.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="wgGroupMemberDueDate">{{lang.dwf_label_duedate}}</label>
                                        <md-datepicker id="wgGroupMemberDueDate"
                                                       md-open-on-focus
                                                       md-min-date="ctrl.minDate"
                                                       ng-model="ctrl.workflowGroupDistributionWorkflow.dueDate"
                                                       required
                                                       name="wgGroupMemberDueDate"></md-datepicker>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="wgGroupMemberEscalationProcess">{{lang.dwf_label_escalation}}</label>
                                        <md-select name="wgGroupMemberEscalationProcess"
                                                   id="wgGroupMemberEscalationProcess"
                                                   required
                                                   ng-model="ctrl.workflowGroupDistributionWorkflow.escalationProcess">
                                            <md-option ng-value="escalationProcess"
                                                       ng-repeat="escalationProcess in ctrl.escalationProcessList track by $index">
                                                {{lang.current==='en'? escalationProcess.enName
                                                :escalationProcess.arName}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableSMSNotification"
                                                   ng-model="ctrl.workflowGroupDistributionWorkflow.smsNotification"
                                                   name="wgGroupMemberSmsNotification"
                                                   id="wgGroupMemberSmsNotification"
                                                   layout-align="center center"
                                                   aria-label="{{lang.sms}}">
                                            <span>{{lang.sms}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.workflowGroupDistributionWorkflow.smsNotification)}}
                                        </md-switch>
                                    </div>
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableEmailNotification"
                                                   ng-model="ctrl.workflowGroupDistributionWorkflow.emailNotification"
                                                   name="wgGroupMemberEmailNotification"
                                                   id="wgGroupMemberEmailNotification"
                                                   layout-align="center center"
                                                   aria-label="{{lang.email_notification}}">
                                            <span>{{lang.email_notification}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.workflowGroupDistributionWorkflow.emailNotification)}}
                                        </md-switch>
                                    </div>
                                    <div>
                                        <div flex>
                                            <md-button class="md-raised"
                                                       ng-disabled="workflowGroups_form.$invalid || ctrl.selectedWorkflowMembers.length=== 0 || ctrl.disableAdd()"
                                                       ng-click="ctrl.addWorkflowMembersToSendDistributionWorkflow(workflowGroups_form)">
                                                {{lang.add}}
                                            </md-button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </md-content>
                </md-tab>
                <!-- Private Users -->
                <md-tab label="{{lang.private_users}}" ng-if="ctrl.showTab('private_users')">
                    <md-content scroll-directive>
                        <form name="distribution_workflow_privateUsers_form" autocomplete="off">
                            <div layout="column" class="p20">
                                <!--<div layout="row" flex>
                                    <md-input-container flex>
                                        <md-select aria-label="select-user"
                                                   ng-model="ctrl.privateUsersSearchBy">
                                            <md-option md-truncate ng-value="criteria"
                                                       ng-repeat="criteria in ctrl.availableSearchCriteriaPrivateUsers track by $index">
                                                {{lang.get(criteria.value)}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="searchForPrivateUsers">{{lang.dwf_label_searchforusers}}</label>
                                        <input name="searchForPrivateUsers" id="searchForPrivateUsers"
                                               ng-change="ctrl.querySearchPrivateUsers()"
                                               ng-model="ctrl.privateUsersSearchText">
                                    </md-input-container>
                                    <span flex></span>
                                    <span flex></span>
                                    <span flex></span>
                                </div>-->
                                <md-card layout="column" class="card-overlay" ng-if="ctrl.allPrivateUsers.length">
                                    <md-table-container flex scroll-directive style="max-height:200px !important;">
                                        <table md-table multiple="{{!ctrl._canNotSendToMultiUsers()}}" md-row-select
                                               ng-model="ctrl.selectedPrivateUsers">
                                            <thead md-head md-order="ctrl.gridPrivateUser.order">
                                            <tr md-row>
                                                <th md-column>
                                                    <md-button class="md-icon-button"
                                                               ng-click="ctrl.addRemoveBulkFavoritePrivateUsers()">
                                                        <md-icon class="star-yellow"
                                                                 md-svg-icon="{{ctrl.selectedAllFavoritePrivateUsers ? 'star' :  'star-outline' }}"></md-icon>
                                                    </md-button>
                                                </th>
                                                <th md-column md-order-by="arName">{{lang.arabic_name}}</th>
                                                <th md-column md-order-by="enName">{{lang.english_name}}</th>
                                                <th md-column>{{lang.organization_unit}}</th>
                                            </tr>
                                            </thead>
                                            <tbody md-body>
                                            <tr md-row md-select="privateUser"
                                                ng-disabled="ctrl.disableRow(privateUser)"
                                                ng-repeat="privateUser in ctrl.allPrivateUsers | limitTo: ctrl.gridPrivateUser.limit: ((ctrl.gridPrivateUser.page - 1) * ctrl.gridPrivateUser.limit) |orderBy:ctrl.gridPrivateUser.order track by $index">
                                                <td md-cell>
                                                    <md-button class="md-icon-button"
                                                               ng-click="ctrl.addRemoveSingleFavoritePrivateUser(privateUser, $event)">
                                                        <md-icon class="star-yellow"
                                                                 md-svg-icon="{{privateUser.selected? 'star' :  'star-outline' }}"></md-icon>
                                                    </md-button>
                                                </td>
                                                <td md-cell>
                                                    {{privateUser.arName}}
                                                </td>
                                                <td md-cell>
                                                    {{privateUser.enName}}
                                                </td>
                                                <td md-cell>
                                                    {{privateUser.getTranslatedOUName()}}
                                                    <!--{{lang.current==='en'? privateUser.ouEnName
                                                    :privateUser.ouArName}}-->
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <md-table-pagination
                                                md-label="{page: '{{lang.page}}', rowsPerPage: '{{lang.rows_per_page}}', of: '{{lang.count_of}}'}"
                                                md-limit-options="ctrl.gridPrivateUser.limitOptions"
                                                md-limit="ctrl.gridPrivateUser.limit"
                                                md-page="ctrl.gridPrivateUser.page"
                                                md-total="{{ctrl.allPrivateUsers.length}}" md-page-select>
                                        </md-table-pagination>
                                    </md-table-container>
                                </md-card>
                                <div layout="row" flex>
                                    <md-input-container flex>
                                        <label for="privateUserSelectedAction">{{lang.dwf_label_selectaction}}</label>
                                        <md-select name="privateUserSelectedAction" id="privateUserSelectedAction"
                                                   required
                                                   ng-model="ctrl.privateUserDistributionWorkflow.action">
                                            <md-option ng-value="action"
                                                       ng-repeat="action in ctrl.userActions track by $index">
                                                {{action.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="distribution_workflow_privateUsers_form.privateUserSelectedAction.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="privateUserDueDate">{{lang.dwf_label_duedate}}</label>
                                        <md-datepicker id="privateUserDueDate"
                                                       md-open-on-focus
                                                       md-min-date="ctrl.minDate"
                                                       ng-model="ctrl.privateUserDistributionWorkflow.dueDate"
                                                       required
                                                       name="privateUserDueDate"></md-datepicker>
                                        <div ng-messages="distribution_workflow_privateUsers_form.privateUserDueDate.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="privateUserEscalationProcess">{{lang.dwf_label_escalation}}</label>
                                        <md-select name="privateUserEscalationProcess"
                                                   id="privateUserEscalationProcess" required
                                                   ng-model="ctrl.privateUserDistributionWorkflow.escalationProcess">
                                            <md-option ng-value="escalationProcess"
                                                       ng-repeat="escalationProcess in ctrl.escalationProcessList track by $index">
                                                {{lang.current==='en'? escalationProcess.enName
                                                :escalationProcess.arName}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="distribution_workflow_privateUsers_form.privateUserEscalationProcess.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableSMSNotification"
                                                   ng-model="ctrl.privateUserDistributionWorkflow.smsNotification"
                                                   id="privateUserSmsNotification"
                                                   name="privateUserSmsNotification"
                                                   layout-align="center center"
                                                   aria-label="{{lang.sms}}">
                                            <span>{{lang.sms}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.privateUserDistributionWorkflow.smsNotification)}}
                                        </md-switch>
                                    </div>
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableEmailNotification"
                                                   ng-model="ctrl.privateUserDistributionWorkflow.emailNotification"
                                                   id="privateUserEmailNotification"
                                                   name="privateUserEmailNotification"
                                                   layout-align="center center"
                                                   aria-label="{{lang.email_notification}}">
                                            <span>{{lang.email_notification}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.privateUserDistributionWorkflow.emailNotification)}}
                                        </md-switch>
                                    </div>
                                    <div>
                                        <div flex>
                                            <md-button class="md-raised"
                                                       ng-disabled="distribution_workflow_privateUsers_form.$invalid || ctrl.selectedPrivateUsers.length=== 0 || ctrl.disableAdd()"
                                                       ng-click="ctrl.addPrivateUserToSendDistributionWorkflow(distribution_workflow_privateUsers_form)">
                                                {{lang.add}}
                                            </md-button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </md-content>
                </md-tab>
                <!-- Head Of Government Entities -->
                <md-tab label="{{lang.head_of_government_entities}}"
                        ng-if="ctrl.showTab('head_of_government_entities')">
                    <md-content scroll-directive>
                        <form name="distribution_workflow_GE_form" autocomplete="off">
                            <div layout="column" class="p20">
                                <md-card layout="column" class="card-overlay" ng-if="ctrl.allGovernmentEntities.length">
                                    <md-table-container flex scroll-directive style="max-height:200px !important;">
                                        <table md-table multiple="{{!ctrl._canNotSendToMultiUsers()}}" md-row-select
                                               ng-model="ctrl.selectedGovernmentEntities">
                                            <thead md-head md-order="ctrl.gridGE.order">
                                            <tr md-row>
                                                <th md-column md-order-by="arName">{{lang.arabic_name}}</th>
                                                <th md-column md-order-by="enName">{{lang.english_name}}</th>
                                                <th md-column>{{lang.organization_unit}}</th>
                                            </tr>
                                            </thead>
                                            <tbody md-body>
                                            <tr md-row md-select="governmentEntity"
                                                ng-disabled="ctrl.disableRow(governmentEntity)"
                                                ng-repeat="governmentEntity in ctrl.allGovernmentEntities | limitTo: ctrl.gridGE.limit: ((ctrl.gridGE.page - 1) * ctrl.gridGE.limit) |orderBy:ctrl.gridGE.order track by $index">
                                                <td md-cell>
                                                    {{governmentEntity.arName}}
                                                </td>
                                                <td md-cell>
                                                    {{governmentEntity.enName}}
                                                </td>
                                                <td md-cell>
                                                    {{governmentEntity.getTranslatedOUName()}}
                                                    <!--{{lang.current==='en'? governmentEntity.ouEnName
                                                    :governmentEntity.ouArName}}-->
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <md-table-pagination
                                                md-label="{page: '{{lang.page}}', rowsPerPage: '{{lang.rows_per_page}}', of: '{{lang.count_of}}'}"
                                                md-limit-options="ctrl.gridGE.limitOptions"
                                                md-limit="ctrl.gridGE.limit"
                                                md-page="ctrl.gridGE.page"
                                                md-total="{{ctrl.allGovernmentEntities.length}}" md-page-select>
                                        </md-table-pagination>
                                    </md-table-container>
                                </md-card>
                                <div layout="row" flex>
                                    <md-input-container flex>
                                        <label for="selectedActionGE">{{lang.dwf_label_selectaction}}</label>
                                        <md-select name="selectedActionGE"
                                                   id="selectedActionGE"
                                                   required
                                                   ng-model="ctrl.governmentEntityDistributionWorkflow.action">
                                            <md-option ng-value="action"
                                                       ng-repeat="action in ctrl.userActions track by $index">
                                                {{action.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="dueDateGE">{{lang.dwf_label_duedate}}</label>
                                        <md-datepicker id="dueDateGE"
                                                       md-min-date="ctrl.minDate"
                                                       md-open-on-focus
                                                       ng-model="ctrl.governmentEntityDistributionWorkflow.dueDate"
                                                       required
                                                       name="dueDateGE"></md-datepicker>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="escalationProcessGE">{{lang.dwf_label_escalation}}</label>
                                        <md-select name="escalationProcessGE"
                                                   id="escalationProcessGE" required
                                                   ng-model="ctrl.governmentEntityDistributionWorkflow.escalationProcess">
                                            <md-option ng-value="escalationProcess"
                                                       ng-repeat="escalationProcess in ctrl.escalationProcessList track by $index">
                                                {{lang.current==='en'? escalationProcess.enName
                                                :escalationProcess.arName}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableSMSNotification"
                                                   ng-model="ctrl.governmentEntityDistributionWorkflow.smsNotification"
                                                   id="smsNotificationGE"
                                                   name="smsNotificationGE"
                                                   layout-align="center center"
                                                   aria-label="{{lang.sms}}">
                                            <span>{{lang.sms}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.governmentEntityDistributionWorkflow.smsNotification)}}
                                        </md-switch>
                                    </div>
                                    <div flex>
                                        <md-switch ng-disabled="!ctrl.enableEmailNotification"
                                                   ng-model="ctrl.governmentEntityDistributionWorkflow.emailNotification"
                                                   id="emailNotificationGE"
                                                   name="emailNotificationGE"
                                                   layout-align="center center"
                                                   aria-label="{{lang.email_notification}}">
                                            <span>{{lang.email_notification}} : </span>
                                            {{ctrl.getTranslatedNotification(ctrl.governmentEntityDistributionWorkflow.emailNotification)}}
                                        </md-switch>
                                    </div>
                                    <div>
                                        <div flex>
                                            <md-button class="md-raised"
                                                       ng-disabled="distribution_workflow_GE_form.$invalid || ctrl.selectedGovernmentEntities.length=== 0 || ctrl.disableAdd()"
                                                       ng-click="ctrl.addGEToSendDistributionWorkflow(distribution_workflow_GE_form)">
                                                {{lang.add}}
                                            </md-button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </md-content>
                </md-tab>
            </md-tabs>
        </md-content>
        <md-divider></md-divider>

        <md-subheader class="md-primary cursor-pointer" ng-click="ctrl.toggleDistributionWorkflowAddedUsers()">
            <!--<span>{{lang.distribution_workflow}} {{lang.users}}</span>-->
            <span>{{lang.users}}</span>
            <md-icon
                    md-svg-icon="{{(ctrl.showDistributionWorkflowAddedUsers) ? 'minus-circle-outline' : 'plus-circle-outline'}}"></md-icon>
        </md-subheader>
        <div ng-if="ctrl.showDistributionWorkflowAddedUsers">
            <md-card style="min-height: 100px !important;max-height:300px !important;">
                <md-table-container flex scroll-directive>
                    <table md-table md-row-select multiple
                           ng-model="ctrl.selectedDistributionWorkflows">
                        <thead md-head>
                        <tr md-row>
                            <th colspan="9" class="table-selector-header"
                                ng-if="ctrl.selectedDistributionWorkflows.length" md-column>
                                <div layout="row" layout-align="start center">
                                    <span>{{ctrl.selectedDistributionWorkflows.length}} {{lang.items_selected}} </span>
                                    <span flex></span>
                                    <md-button class="md-icon-button"
                                               ng-click="ctrl.removeAllDistributionWorkflowUsers()">
                                        <md-icon md-svg-icon="delete"></md-icon>
                                    </md-button>
                                </div>
                            </th>
                            <th ng-if="!ctrl.selectedDistributionWorkflows.length" md-column>
                                <span>{{lang.name}}</span>
                            </th>
                            <!--<th ng-if="!ctrl.selectedDistributionWorkflows.length" md-column>
                                <span>{{lang.english_name}}</span>
                            </th>-->
                            <th ng-if="!ctrl.selectedDistributionWorkflows.length" md-column>
                                <span>{{lang.organization_unit}}</span>
                            </th>
                            <th ng-if="!ctrl.selectedDistributionWorkflows.length" md-column>
                                <span>{{lang.action}}</span>
                            </th>
                            <th ng-if="!ctrl.selectedDistributionWorkflows.length" md-column>
                                <span>{{lang.due}}</span>
                            </th>
                            <th ng-if="!ctrl.selectedDistributionWorkflows.length" md-column>
                                <span>{{lang.sms}}</span>
                            </th>
                            <th ng-if="!ctrl.selectedDistributionWorkflows.length" md-column>
                                <span>{{lang.email_notification}}</span>
                            </th>
                            <!--<th ng-if="!ctrl.selectedDistributionWorkflows.length" md-column>-->
                            <!--<span>{{lang.dwf_result_escalation}}</span>-->
                            <!--</th>-->
                            <th ng-if="!ctrl.selectedDistributionWorkflows.length" md-column>
                                <span>{{lang.action}}</span>
                            </th>
                        </tr>
                        </thead>
                        <tbody md-body>
                        <tr md-row md-select="distributionWorkflow"
                            ng-repeat="distributionWorkflow in ctrl.allSelectedDistributionWorkflows | limitTo: ctrl.gridSendDistributionWorkflow.limit: ((ctrl.gridSendDistributionWorkflow.page - 1) * ctrl.gridSendDistributionWorkflow.limit) |orderBy:ctrl.gridSendDistributionWorkflow.order track by $index">
                            <td md-cell>
                                {{lang.current==="ar"? distributionWorkflow.arName:distributionWorkflow.enName}}
                            </td>
                            <!-- <td md-cell>
                                 {{distributionWorkflow.enName}}
                             </td>-->
                            <td md-cell>
                                {{lang.current==='ar'? distributionWorkflow.ouArName
                                :distributionWorkflow.ouEnName}}
                            </td>
                            <td md-cell>
                                <md-select name="{{distributionWorkflow.userId}}" id="{{distributionWorkflow.userId}}"
                                           ng-model-options="{trackBy: '$value.id'}"
                                           ng-model="distributionWorkflow.action" aria-label="actions">
                                    <md-option ng-value="action"
                                               ng-repeat="action in ctrl.userActions track by $index">
                                        {{action.getTranslatedName()}}
                                    </md-option>
                                </md-select>
                            </td>
                            <td md-cell>
                                {{ctrl.getFormatedDueDate(distributionWorkflow.dueDate)}}
                            </td>
                            <td md-cell>
                                <md-switch ng-disabled="!ctrl.enableSMSNotification"
                                           ng-model="distributionWorkflow.smsNotification"
                                           aria-label="{{lang.dwf_label_smsnotification}}">
                                </md-switch>
                            </td>
                            <td md-cell>
                                <md-switch ng-disabled="!ctrl.enableEmailNotification"
                                           ng-model="distributionWorkflow.emailNotification"
                                           aria-label="{{lang.dwf_label_emailnotification}}">
                                </md-switch>
                            </td>
                            <!--<td md-cell>-->
                            <!--{{ctrl.getTranslatedEscalationProcess(distributionWorkflow.escalationProcess)}}-->
                            <!--</td>-->
                            <td md-cell>
                                <div flex layout="row" layout-align="start center">
                                    <md-button class="md-icon-button" title="{{lang.delete}}"
                                               ng-click="ctrl.removeSingleDistributionWorkflowUser(distributionWorkflow, $event)">
                                        <md-icon md-svg-icon="delete"></md-icon>
                                    </md-button>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <md-table-pagination
                            md-label="{page: '{{lang.page}}', rowsPerPage: '{{lang.rows_per_page}}', of: '{{lang.count_of}}'}"
                            md-limit-options="ctrl.gridSendDistributionWorkflow.limitOptions"
                            md-limit="ctrl.gridSendDistributionWorkflow.limit"
                            md-page="ctrl.gridSendDistributionWorkflow.page"
                            md-total="{{ctrl.allSelectedDistributionWorkflows.length}}" md-page-select>
                    </md-table-pagination>
                </md-table-container>
            </md-card>
            <div>
                <div layout="row">
                    <md-button
                            ng-if="ctrl.selectedBooks.length!==0"
                            class="md-raised"
                            ng-disabled="ctrl.allSelectedDistributionWorkflows.length===0"
                            ng-click="ctrl.launchDistributionWorkflowBulk()">
                        {{lang.send_bulk_distribution_workflow}}
                    </md-button>
                    <md-button
                            ng-if="(!ctrl.isForwardButton || ctrl.isReplyButton) && (ctrl.isForwardButton || !ctrl.isReplyButton) && (ctrl.selectedBooks.length===0)"
                            class="md-raised"
                            ng-disabled="ctrl.allSelectedDistributionWorkflows.length===0"
                            ng-click="ctrl.launchDistributionWorkflow()">
                        {{lang.send}}
                    </md-button>
                    <md-button ng-if="ctrl.isForwardButton" class="md-raised"
                               ng-disabled="ctrl.allSelectedDistributionWorkflows.length===0"
                               ng-click="ctrl.forwardDistributionWorkflow()">
                        {{lang.forward_distribution_workflow}}
                    </md-button>
                    <md-button ng-if="ctrl.isReplyButton" class="md-raised"
                               ng-disabled="ctrl.allSelectedDistributionWorkflows.length===0"
                               ng-click="ctrl.replyDistributionWorkflow()">
                        {{lang.reply}}
                    </md-button>
                </div>
            </div>
        </div>
    </div>
</md-dialog>