<md-dialog id="correspondence-dialog" ng-class="{'fullscreen':ctrl.fullScreen}"
           ng-attr-aria-label="{{lang.view_document}}">
    <div flex layout="column">
        <div>
            <div flex layout="row" layout-align="start center">
                <md-button ng-if="ctrl.correspondence" ng-click="ctrl.toggleCorrespondenceDetails()"
                           class="md-icon-button">
                    <md-icon md-svg-icon="menu"></md-icon>
                </md-button>
                <correspondence-view-action-directive ng-if="ctrl.actions.length" actions="ctrl.actions"
                                                      work-item="ctrl.workItem"
                                                      correspondence="ctrl.correspondence"></correspondence-view-action-directive>
                <div flex layout-align="center center" layout="row">
                    <span>{{::ctrl.correspondence.getTranslatedName()}}</span>
                </div>
                <md-button ng-click="ctrl.toggleFullScreen()" class="md-icon-button">
                    <md-icon md-svg-icon="fullscreen"></md-icon>
                </md-button>
                <md-button ng-if="!ctrl.correspondence" ng-click="ctrl.returnBackCorrespondenceInformation()"
                           class="md-icon-button">
                    <md-icon md-svg-icon="close"></md-icon>
                </md-button>
                <md-button ng-if="ctrl.correspondence" ng-click="ctrl.closeCorrespondenceDialog()"
                           class="md-icon-button">
                    <md-icon md-svg-icon="close"></md-icon>
                </md-button>
            </div>
        </div>
        <div layout="row" flex>
            <md-sidenav md-is-locked-open="!ctrl.fullScreen" ng-if="false">
                <div class="p20" layout="column" scroll-directive>
                    <ul id="document-properties">
                        <li class="document-properties">
                            <ul ng-if="!!ctrl.workItem" class="work-item-properties">
                                <li>
                                    <span class="property-key">{{lang.previous_action}}</span>
                                    <span class="property-value">{{ctrl.workItem.action.getTranslatedName()}}</span>
                                </li>
                                <li>
                                    <span class="property-key">{{lang.previous_comment}}</span>
                                    <span class="property-value">{{ctrl.workItem.comments}}</span>
                                </li>
                                <li>
                                    <span class="property-key">{{lang.work_item_sender}}</span>
                                    <span class="property-value">{{ctrl.workItem.senderInfo.getTranslatedName()}}</span>
                                </li>
                                <li>
                                    <span class="property-key">{{lang.action_date}}</span>
                                    <span class="property-value">{{ctrl.workItem.getReceivedDate()}}</span>
                                </li>
                                <li>
                                    <span class="property-key">{{lang.time}}</span>
                                    <span class="property-value">{{ctrl.workItem.getReceivedTime()}}</span>
                                </li>
                            </ul>
                        </li>
                        <li class="document-properties">
                            <ul class="correspondence-properties">
                                <li>
                                    <span class="property-key">{{lang.document_number}}</span>
                                    <span class="property-value">{{ctrl.workItem.getReceivedTime()}}</span>
                                </li>
                                <li>
                                    <span class="property-key">{{lang.document_number}}</span>
                                    <span class="property-value">{{ctrl.workItem.getReceivedTime()}}</span>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </md-sidenav>
            <md-sidenav ng-if="ctrl.detailsReady && ctrl.correspondence" id="correspondence-details"
                        md-whiteframe="3"
                        ng-class="{'md-sidenav-right':lang.current === 'ar'}"
                        md-component-id="correspondence-details">
                <div class="p20" scroll-directive>
                    <accordion-directive label-collapse="true" validation="ctrl.validation">
                        <accordion-item fail-when="ctrl.document_properties.$invalid"
                                        pass-when="ctrl.document_properties.$valid">
                            <accordion-title>
                                <md-icon md-svg-icon="file-document-box"></md-icon>
                                <span> &nbsp;{{lang.document_properties}}</span>
                            </accordion-title>
                            <accordion-content>
                                <manage-properties-directive
                                        source-model="ctrl.model"
                                        source-form="ctrl.document_properties"
                                        document="ctrl.correspondence"
                                        disable-properties="ctrl.disableProperties">
                                </manage-properties-directive>
                            </accordion-content>
                        </accordion-item>
                        <accordion-item ng-if="ctrl.hasCorrespondenceSite()"
                                        fail-when="!ctrl.correspondence.sitesInfoTo.length"
                                        pass-when="!!ctrl.correspondence.sitesInfoTo.length">
                            <accordion-title>
                                <md-icon md-svg-icon="arrange-send-backward"></md-icon>
                                <span>{{lang.manage_correspondence_sites}}{{ctrl.correspondence.docClassName}}</span>
                            </accordion-title>
                            <accordion-content>
                                <div>
                                    <manage-correspondence-sites-directive
                                            ng-if="ctrl.correspondence.docClassName !== 'Incoming'"
                                            vs-id="ctrl.correspondence.vsId"
                                            document-class="ctrl.correspondence.docClassName"
                                            sites-info-c-c="ctrl.correspondence.sitesInfoCC"
                                            sites-info-to="ctrl.correspondence.sitesInfoTo"
                                            disable-correspondence="ctrl.disableCorrespondence">
                                    </manage-correspondence-sites-directive>
                                    <manage-correspondence-site-incoming-directive
                                            ng-if="ctrl.correspondence.docClassName == 'Incoming'"
                                            vs-id="ctrl.correspondence.vsId"
                                            site="ctrl.correspondence.site"
                                            document-class="ctrl.correspondence.docClassName"
                                            disable-correspondence="ctrl.disableCorrespondence"></manage-correspondence-site-incoming-directive>
                                </div>
                            </accordion-content>
                        </accordion-item>
                        <!--<accordion-item pass-when="ctrl.documentInformation || ctrl.correspondence.contentFile">
                            <accordion-title>
                                <md-icon md-svg-icon="format-align-justify"></md-icon>
                                <span>{{lang.outgoing_create_content}}</span>
                            </accordion-title>
                            <accordion-content>
                                <div layout="row">
                                    <manage-content-directive
                                            display-prepare="!ctrl.correspondence.addMethod"
                                            document-information="ctrl.documentInformation"
                                            vs-id="ctrl.correspondence.vsId"
                                            document="ctrl.correspondence"
                                            signatures-count="ctrl.correspondence.signaturesCount"
                                            templates="ctrl.templates"></manage-content-directive>
                                </div>
                            </accordion-content>
                        </accordion-item>-->
                        <accordion-item pass-when="!!ctrl.correspondence.tags.length">
                            <accordion-title>
                                <md-icon md-svg-icon="tag-multiple"></md-icon>
                                <span>{{lang.outgoing_manage_tags}}</span>
                            </accordion-title>
                            <accordion-content>
                                <div>
                                    <manage-tags-directive from-dialog="false"
                                                           tags="ctrl.correspondence.tags"
                                                           disable-everything="ctrl.disableEverything">
                                    </manage-tags-directive>
                                </div>
                            </accordion-content>
                        </accordion-item>
                        <accordion-item pass-when="!!ctrl.correspondence.linkedDocs.length">
                            <accordion-title>
                                <md-icon md-svg-icon="note-multiple-outline"></md-icon>
                                <span>{{lang.outgoing_manage_linked_document}}</span>
                            </accordion-title>
                            <accordion-content>
                                <div>
                                    <manage-linked-document-directive
                                            linked-docs="ctrl.correspondence.linkedDocs"
                                            vs-id="ctrl.correspondence.vsId"
                                            document-class="ctrl.correspondence.docClassName"
                                            disable-everything="ctrl.disableEverything">
                                    </manage-linked-document-directive>
                                </div>
                            </accordion-content>
                        </accordion-item>
                        <accordion-item pass-when="!!ctrl.correspondence.attachments.length">
                            <accordion-title>
                                <md-icon md-svg-icon="attachment"></md-icon>
                                <span>{{lang.outgoing_manage_attachments}}</span>
                            </accordion-title>
                            <accordion-content>
                                <div layout="row">
                                    <manage-attachment-directive
                                            document="ctrl.correspondence"
                                            attachments="ctrl.correspondence.attachments"
                                            vs-id="ctrl.correspondence.vsId"
                                            document-class="ctrl.correspondence.docClassName"
                                            disable-everything="ctrl.disableEverything" flex>
                                    </manage-attachment-directive>
                                </div>
                            </accordion-content>
                        </accordion-item>
                        <accordion-item pass-when="!!ctrl.correspondence.documentComments.length"
                                        ng-if="ctrl.employeeService.hasPermissionTo('MANAGE_DOCUMENT’S_COMMENTS')">
                            <accordion-title>
                                <md-icon md-svg-icon="comment"></md-icon>
                                <span>{{lang.outgoing_manage_comments}}</span>
                            </accordion-title>
                            <accordion-content>
                                <div layout="row">
                                    <manage-comments-directive
                                            vs-id="ctrl.correspondence.vsId"
                                            document-comments="ctrl.correspondence.documentComments"
                                            show-comment-form="ctrl.showDocumentComment"
                                            disable-everything="ctrl.disableEverything"
                                            flex>
                                    </manage-comments-directive>
                                </div>
                            </accordion-content>
                        </accordion-item>
                        <accordion-item pass-when="!!ctrl.correspondence.linkedEntities.length">
                            <accordion-title>
                                <md-icon md-svg-icon="vector-triangle"></md-icon>
                                <span>{{lang.outgoing_linked_entities}}</span>
                            </accordion-title>
                            <accordion-content>
                                <div>
                                    <manage-entities-directive
                                            vs-id="ctrl.correspondence.vsId"
                                            linked-entities="ctrl.correspondence.linkedEntities"
                                            document-class="ctrl.correspondence.docClassName"
                                            disable-everything="ctrl.disableEverything">
                                    </manage-entities-directive>
                                </div>
                            </accordion-content>
                        </accordion-item>
                    </accordion-directive>
                </div>
            </md-sidenav>
            <iframe ng-src="{{ctrl.content.viewURL}}" flex frameborder="0"></iframe>
            <!--class="document-viewer-full-width-height"-->
        </div>
        <div layout="row">
            <div ng-if="ctrl.correspondence">
                <md-button class="md-raised" ng-click="ctrl.saveCorrespondenceChanges()"
                           ng-disabled="ctrl.checkDisabled()">{{lang.save}}
                </md-button>
            </div>
            <div ng-if="!ctrl.correspondence">
                <md-button class="md-raised" ng-click="ctrl.returnBackCorrespondenceInformation()">{{lang.save}}
                </md-button>
            </div>
            <span flex></span>
            <div ng-if="ctrl.correspondence">
                <md-button class="md-raised" ng-click="ctrl.closeCorrespondenceDialog()">{{lang.close}}</md-button>
            </div>
            <div ng-if="!ctrl.correspondence">
                <md-button class="md-raised" ng-click="ctrl.returnBackCorrespondenceInformation()">{{lang.close}}
                </md-button>
            </div>
        </div>
    </div>
</md-dialog>