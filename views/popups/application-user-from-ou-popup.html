<md-dialog class="dialog-extend mw60"
           ng-class="{'cms-dialog-full-screen':ctrl.fullScreen}"
           ng-attr-aria-label="{{!ctrl.editMode ? lang.add_new_application_user: ctrl.model.getNames()}}">
    <popup-toolbar-directive ng-if="!ctrl.editMode"
                             header-text="{{lang.add_new_application_user}}"
    ></popup-toolbar-directive>
    <popup-toolbar-directive ng-if="ctrl.editMode"
                             header-text="{{ctrl.model.getNames()}}"
    ></popup-toolbar-directive>
    <md-dialog-content scroll-directive>
        <div>
            <form name="applicationUserForm" autocomplete="off">
                <md-tabs md-dynamic-height>
                    <!-- Basic Info Tab -->
                    <md-tab label="{{lang.basic_info}}" md-on-select="ctrl.setCurrentTab('basic')">
                        <md-content class="md-padding">
                            <div layout="column">
                                <div layout="row" flex>
                                    <!-- Arabic Full Name -->
                                    <md-input-container flex>
                                        <label for="arFullName">{{lang.arabic_full_name}}</label>
                                        <input name="arFullName" id="arFullName" required minlength="4"
                                               ng-model="ctrl.applicationUser.arFullName" maxlength="80">
                                        <div ng-messages="applicationUserForm.arFullName.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                            <div ng-message="minlength">{{lang.short}}</div>
                                            <div ng-message="maxlength">{{lang.max_length.change({length:80})}}</div>
                                        </div>
                                    </md-input-container>
                                    <!-- English Full Name -->
                                    <md-input-container flex>
                                        <label for="enFullName">{{lang.english_full_name}}</label>
                                        <input name="enFullName" id="enFullName" required minlength="4"
                                               ng-model="ctrl.applicationUser.enFullName" maxlength="80">
                                        <div ng-messages="applicationUserForm.enFullName.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                            <div ng-message="minlength">{{lang.short}}</div>
                                            <div ng-message="maxlength">{{lang.max_length.change({length:80})}}</div>
                                        </div>
                                    </md-input-container>
                                </div>
                                <div layout="row" flex>
                                    <!-- Gender -->
                                    <md-input-container flex>
                                        <label for="gender">{{lang.gender}}</label>
                                        <md-select id="gender" name="gender" required
                                                   ng-model="ctrl.applicationUser.gender">
                                            <md-option ng-value="gender.lookupKey"
                                                       ng-repeat="gender in ctrl.genders track by $index">
                                                {{gender.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="applicationUserForm.gender.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <!-- Login Name -->
                                    <md-input-container flex>
                                        <label for="loginName">{{lang.login_name}}</label>
                                        <input name="loginName" id="loginName" required minlength="2"
                                               ng-model="ctrl.applicationUser.loginName"
                                               maxlength="50" ng-disabled="ctrl.editMode && !ctrl.employeeService.getEmployee().isAdmin"
                                               no-space-directive custom-validate-directive="FILE_NET_USER">
                                        <div ng-messages="applicationUserForm.loginName.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                            <div ng-message="minlength">{{lang.short}}</div>
                                            <div ng-message="FILE_NET_USER">{{lang.english_number}}</div>
                                        </div>
                                    </md-input-container>
                                </div>
                                <div layout="row" flex>
                                    <!-- Employee Number -->
                                    <md-input-container flex>
                                        <label for="employeeNo">{{lang.employee_number}}</label>
                                        <input name="employeeNo" id="employeeNo" required
                                               ng-model="ctrl.applicationUser.employeeNo" maxlength="10"
                                               custom-validate-directive="number">
                                        <div ng-messages="applicationUserForm.employeeNo.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                            <div ng-message="number">{{lang.numberonly}}</div>
                                            <div ng-message="maxlength">{{lang.max_length.change({length:10})}}</div>
                                        </div>
                                    </md-input-container>
                                    <!-- Qatari Id -->
                                    <md-input-container flex>
                                        <label for="qid">{{lang.qid}}</label>
                                        <input name="qid" id="qid" required maxlength="11"
                                               ng-model="ctrl.applicationUser.qid"
                                               custom-validate-directive="number">
                                        <div ng-messages="applicationUserForm.qid.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                            <div ng-message="number">{{lang.numberonly}}</div>
                                            <div ng-message="maxlength">{{lang.max_length.change({length:11})}}</div>
                                        </div>
                                    </md-input-container>
                                </div>
                                <div layout="row" flex>
                                    <!-- Domain Name -->
                                    <md-input-container flex>
                                        <label for="domainName">{{lang.domain_name}}</label>
                                        <input name="domainName" id="domainName" required minlength="2"
                                               ng-model="ctrl.applicationUser.domainName" maxlength="50"
                                               ng-disabled="ctrl.editMode && !ctrl.employeeService.getEmployee().isAdmin"
                                               no-space-directive custom-validate-directive="FILE_NET_USER">
                                        <div ng-messages="applicationUserForm.domainName.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                            <div ng-message="minlength">{{lang.short}}</div>
                                            <div ng-message="maxlength">{{lang.max_length.change({length:20})}}</div>
                                            <div ng-message="FILE_NET_USER">{{lang.english_number}}</div>
                                        </div>
                                    </md-input-container>
                                    <!-- Job Title -->
                                    <div flex layout="row">
                                        <md-input-container flex>
                                            <label for="jobTitle">{{lang.job_title}}</label>
                                            <md-select id="jobTitle" name="jobTitle" required
                                                       ng-model="ctrl.applicationUser.jobTitle">
                                                <md-option ng-disabled="!jobTitle.status"
                                                           ng-value="jobTitle.lookupKey"
                                                           tooltip="{{(!jobTitle.status) ? lang.inactive : ''}}"
                                                           ng-repeat="jobTitle in ctrl.jobTitles track by $index">
                                                    <!--ng-if="jobTitle.status" -->
                                                    {{jobTitle.getTranslatedName()}}
                                                </md-option>
                                            </md-select>
                                            <div ng-messages="applicationUserForm.jobTitle.$error">
                                                <div ng-message="required">{{lang.field_required}}</div>
                                            </div>
                                        </md-input-container>
                                        <md-input-container>
                                            <md-button
                                                    tooltip="{{lang.add_new_job_title}}"
                                                    ng-click="ctrl.openAddJobTitleDialog($event)"
                                                    class="md-icon-button">
                                                <md-icon md-svg-icon="plus"></md-icon>
                                            </md-button>
                                        </md-input-container>
                                    </div>
                                </div>
                                <div layout="row" flex>
                                    <!-- Rank -->
                                    <div flex layout="row">
                                        <md-input-container flex>
                                            <label for="rank">{{lang.rank}}</label>
                                            <md-select id="rank" name="rank"
                                                       ng-model="ctrl.applicationUser.rank"><!-- required-->
                                                <md-option ng-if="rank.status" ng-value="rank.lookupKey"
                                                           ng-repeat="rank in ctrl.ranks track by $index">
                                                    {{rank.getTranslatedName()}}
                                                </md-option>
                                            </md-select>
                                            <div ng-messages="applicationUserForm.rank.$error">
                                                <div ng-message="required">{{lang.field_required}}</div>
                                            </div>
                                        </md-input-container>
                                        <md-input-container>
                                            <md-button
                                                    tooltip="{{lang.add_new_rank}}"
                                                    ng-click="ctrl.openAddRankDialog($event)"
                                                    class="md-icon-button">
                                                <md-icon md-svg-icon="plus"></md-icon>
                                            </md-button>
                                        </md-input-container>
                                    </div>
                                    <!-- Mobile Number -->
                                    <md-input-container flex>
                                        <label for="mobile">{{lang.mobile_number}}</label>
                                        <input name="mobile" id="mobile" required
                                               ng-model="ctrl.applicationUser.mobile" maxlength="15"
                                               custom-validate-directive="phone_mobile">
                                        <div ng-messages="applicationUserForm.mobile.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                            <div ng-message="phone_mobile">
                                                {{lang.invalid_phone_mobile.change({phonemob:lang.mobile})}}
                                            </div>
                                            <div ng-message="maxlength">{{lang.max_length.change({length:15})}}</div>
                                        </div>
                                    </md-input-container>
                                    <!-- Registered Mobile Number for OTP -->
                                    <!--<md-input-container flex> &lt;!&ndash;class=not-found&ndash;&gt;
                                        <label for="mobileOTP">{{lang.mobile_number_otp}}</label>
                                        <input name="mobileOTP" id="mobileOTP"
                                               ng-model="ctrl.notFound.mobile" maxlength="15"
                                               custom-validate-directive="phone_mobile">
                                        <div ng-messages="applicationUserForm.mobileOTP.$error">
                                            <div ng-message="phone_mobile">
                                                {{lang.invalid_phone_mobile.change({phonemob:lang.mobile})}}
                                            </div>
                                            <div ng-message="maxlength">{{lang.max_length.change({length:15})}}</div>
                                        </div>
                                    </md-input-container>-->
                                </div>
                                <div layout="row" flex>
                                    <!-- Email -->
                                    <md-input-container flex>
                                        <label for="email">{{lang.email}}</label>
                                        <input name="email" id="email" required maxlength="50"
                                               ng-model="ctrl.applicationUser.email"
                                               custom-validate-directive="email">
                                        <div ng-messages="applicationUserForm.email.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                            <div ng-message="email">
                                                {{lang.invalid_email}}
                                            </div>
                                            <div ng-message="maxlength">{{lang.max_length.change({length:50})}}</div>
                                        </div>
                                    </md-input-container>
                                    <!-- Language -->
                                    <md-input-container flex>
                                        <label for="defaultDisplayLang">{{lang.default_language}}</label>
                                        <md-select id="defaultDisplayLang" name="defaultDisplayLang" required
                                                   ng-model="ctrl.applicationUser.defaultDisplayLang">
                                            <md-option ng-value="language.lookupKey"
                                                       ng-repeat="language in ctrl.languages track by $index">
                                                {{language.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="applicationUserForm.defaultDisplayLang.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                </div>
                                <div layout="row" flex>
                                    <!-- Search Amount Limit -->
                                    <md-input-container flex>
                                        <label for="searchAmountLimit">{{lang.default_max_row_search}}</label>
                                        <input name="searchAmountLimit" id="searchAmountLimit" required
                                               ng-model="ctrl.applicationUser.searchAmountLimit" maxlength="5"
                                               min-max-number-directive min="0" max="ctrl.maxRowCount"
                                               custom-validate-directive="number">
                                        <div ng-messages="applicationUserForm.searchAmountLimit.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                            <div ng-message="maxlength">{{lang.max_length.change({length:5})}}</div>
                                            <div ng-message="number">{{lang.numberonly}}</div>
                                            <div ng-message="min">{{lang.min_number.change({number:0})}}</div>
                                            <div ng-message="max">
                                                {{lang.max_number.change({number:ctrl.maxRowCount})}}
                                            </div>
                                        </div>
                                    </md-input-container>
                                    <!-- Theme -->
                                    <div flex layout="row">
                                        <md-input-container flex>
                                            <label for="defaultThemeID">{{lang.default_theme}}</label>
                                            <md-select id="defaultThemeID" name="defaultThemeID" required
                                                       ng-model="ctrl.applicationUser.defaultThemeID">
                                                <md-option ng-value="theme.id"
                                                           ng-repeat="theme in ctrl.themes track by $index">
                                                    {{theme.getTranslatedName()}}
                                                </md-option>
                                            </md-select>
                                            <div ng-messages="applicationUserForm.defaultThemeID.$error">
                                                <div ng-message="required">{{lang.field_required}}</div>
                                            </div>
                                        </md-input-container>
                                        <md-input-container>
                                            <md-button
                                                    tooltip="{{lang.add_new_theme}}"
                                                    ng-click="ctrl.openAddThemeDialog($event)"
                                                    class="md-icon-button">
                                                <md-icon md-svg-icon="plus"></md-icon>
                                            </md-button>
                                        </md-input-container>
                                    </div>
                                </div>
                                <div layout="row" flex>
                                    <!-- Roles -->
                                    <md-input-container flex>
                                        <label for="customRoleId">{{lang.role}}</label>
                                        <md-select id="customRoleId" name="customRoleId" required
                                                   ng-disabled="ctrl.ouApplicationUser.id"
                                                   ng-model-options="{trackBy:'$value.id'}"
                                                   ng-model="ctrl.ouApplicationUser.customRoleId"
                                                   md-on-close="ctrl.clearSearchText('role')"
                                                   data-md-container-class="select-header-container">
                                            <md-select-header class="select-header">
                                                <input ng-model="ctrl.roleSearchText"
                                                       ng-keydown="ctrl.preventSearchKeyDown($event)"
                                                       placeholder="{{lang.search}}"
                                                       class="select-header-input">
                                            </md-select-header>
                                            <md-option ng-repeat="role in ctrl.roles | translatedNameFilter: ctrl.roleSearchText"
                                                       ng-value="role" ng-disabled="!role.status">
                                                <span
                                                        md-highlight-text="ctrl.roleSearchText"
                                                        md-highlight-flags="i">{{role.getTranslatedName()}}</span>
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="applicationUserForm.customRoleId.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <!-- View Inbox -->
                                    <md-input-container flex>
                                        <label for="viewInboxAsGrid">{{lang.view_inbox_as}}</label>
                                        <md-select id="viewInboxAsGrid" name="viewInboxAsGrid" required
                                                   ng-model="ctrl.applicationUser.viewInboxAsGrid">
                                            <md-option ng-value="viewType.value"
                                                       ng-repeat="viewType in ctrl.viewInboxAsOptions track by $index">
                                                {{lang[viewType.key]}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="applicationUserForm.viewInboxAsGrid.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                </div>
                                <div layout="row" flex>
                                    <!-- View Security Levels -->
                                    <md-input-container flex>
                                        <label for="ouSecurityLevel">{{lang.security_level_view}} {{lang.security_levels}}</label>
                                        <md-select id="ouSecurityLevel" name="ouSecurityLevel" multiple
                                                   ng-required="!ctrl.ouApplicationUser.archiveSecurityLevels || !ctrl.ouApplicationUser.archiveSecurityLevels.length"
                                                   ng-model-options="{trackBy:'$value.lookupKey'}"
                                                   ng-model="ctrl.ouApplicationUser.securityLevels">
                                            <md-option ng-value="securityLevel"
                                                       ng-repeat="securityLevel in ctrl.securityLevels">
                                                {{securityLevel.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="applicationUserForm.ouSecurityLevel.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <!-- Security Levels -->
                                    <md-input-container flex>
                                        <label for="ouArchiveSecurityLevel">{{lang.security_levels}}</label>
                                        <md-select id="ouArchiveSecurityLevel" name="ouArchiveSecurityLevel" multiple
                                                   ng-required="!ctrl.ouApplicationUser.securityLevels || !ctrl.ouApplicationUser.securityLevels.length"
                                                   ng-model-options="{trackBy:'$value.lookupKey'}"
                                                   ng-model="ctrl.ouApplicationUser.archiveSecurityLevels">
                                            <md-option ng-value="securityLevel"
                                                       ng-repeat="securityLevel in ctrl.securityLevels">
                                                {{securityLevel.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="applicationUserForm.ouArchiveSecurityLevel.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                </div>
                                <div layout="row">
                                    <md-input-container flex>
                                        <label for="defaultViewerLang">{{lang.default_viewer_language}}</label>
                                        <md-select id="defaultViewerLang" name="defaultViewerLang" required
                                                   ng-model="ctrl.applicationUser.defaultViewerLang">
                                            <md-option ng-value="language.lookupKey"
                                                       ng-repeat="language in ctrl.languages track by $index">
                                                {{language.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="applicationUserForm.defaultViewerLang.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="defaultEditMode">{{lang.default_edit_mode}}</label>
                                        <md-select id="defaultEditMode" name="defaultEditMode"
                                                   ng-model="ctrl.applicationUser.defaultEditMode">
                                            <md-option ng-value="0">{{lang.both_editor}}</md-option>
                                            <md-option ng-value="1">{{lang.oos}}</md-option>
                                            <md-option ng-value="2">{{lang.desktop}}</md-option>
                                        </md-select>
                                    </md-input-container>
                                </div>
                                <div layout="row">
                                    <!-- Organization Unit -->
                                    <md-input-container ng-if="ctrl.editMode" flex>
                                        <label for="defaultOUID">{{lang.organization_unit}}</label>
                                        <md-select id="defaultOUID" name="defaultOUID" required
                                                   ng-model="ctrl.applicationUser.defaultOUID">
                                            <md-option ng-value="organization.ou.id"
                                                       ng-disabled="!organization.status"
                                                       tooltip="{{(!organization.status) ? lang.inactive_organization : ''}}"
                                                       ng-repeat="organization in ctrl.organizationsForAppUser track by $index">
                                                {{organization.ou.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="applicationUserForm.defaultOUID.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <md-switch flex ng-model="ctrl.applicationUser.slowConnectionMode"
                                               aria-label="{{lang.slow_connection_mode}}">
                                        <label>{{lang.slow_connection_mode}} :
                                            {{ctrl.applicationUser.getTranslatedYesNo('slowConnectionMode')}}</label>
                                    </md-switch>
                                    <md-switch flex ng-model="ctrl.applicationUser.backLogMode"
                                               aria-label="{{lang.backlog_mode}}">
                                        <label>{{lang.backlog_mode}} :
                                            {{ctrl.applicationUser.getTranslatedYesNo('backLogMode')}}</label>
                                    </md-switch>
                                </div>
                            </div>
                        </md-content>
                    </md-tab>
                    <!-- Notification Settings Tab -->
                    <md-tab label="{{lang.notification_settings}}" md-on-select="ctrl.setCurrentTab('ns')">
                        <md-content class="md-padding">
                            <div layout="column">
                                <!-- SMS Notifications -->
                                <fieldset flex>
                                    <legend class="md-accent">
                                        <!-- Subscription SMS Switch -->
                                        {{lang.sms_settings}}
                                    </legend>
                                    <span class="red-text" ng-if="!ctrl.globalSetting.enableSMSNotification">{{lang.setting_disabled_by_admin}}</span>
                                    <div layout="row">
                                        <md-switch flex ng-model="ctrl.applicationUser.subscriptionsmsNotify"
                                                   ng-disabled="!ctrl.globalSetting.enableSMSNotification"
                                                   aria-label="{{lang.subscription_sms}}">
                                            <label>{{lang.subscription_sms}}</label>
                                        </md-switch>
                                    </div>
                                    <!-- New Item SMS and Priority -->
                                    <div layout="row">
                                        <!-- New Item SMS -->
                                        <md-switch flex ng-model="ctrl.applicationUser.newsmsEmailNotify"
                                                   ng-disabled="!ctrl.globalSetting.enableSMSNotification"
                                                   ng-change="ctrl.resetNotificationsAppUser('newsmsEmailNotify','newItemSmspriority',[applicationUserForm.newItemSmspriority])"
                                                   aria-label="{{lang.new_item_sms}}">
                                            <label>{{lang.new_item_sms}} :
                                                {{ctrl.applicationUser.getTranslatedYesNo('newsmsEmailNotify')}}</label>
                                        </md-switch>
                                        <!-- New Item SMS Priority -->
                                        <md-input-container flex>
                                            <label for="newItemSmspriority">{{lang.new_item_sms_priority}}</label>
                                            <md-select multiple ng-required="ctrl.applicationUser.newsmsEmailNotify"
                                                       ng-disabled="!ctrl.globalSetting.enableSMSNotification || !ctrl.applicationUser.newsmsEmailNotify"
                                                       ng-readonly="!ctrl.applicationUser.newsmsEmailNotify"
                                                       name="newItemSmspriority" id="newItemSmspriority"
                                                       ng-model="ctrl.applicationUser.newItemSmspriority">
                                                <md-option ng-value="priorityLevel"
                                                           ng-repeat="priorityLevel in ctrl.priorityLevels track by $index">
                                                    {{priorityLevel.getTranslatedName()}}
                                                </md-option>
                                            </md-select>
                                            <div ng-messages="applicationUserForm.newItemSmspriority.$error">
                                                <div ng-message="required">{{lang.field_required}}</div>
                                                <div ng-message="number">{{lang.numberonly}}</div>
                                                <div ng-message="maxlength">{{lang.max_length.change({length:5})}}</div>
                                            </div>
                                        </md-input-container>
                                    </div>
                                    <!-- Deadline SMS and Priority -->
                                    <div layout="row">
                                        <!-- Deadline SMS -->
                                        <md-switch flex ng-model="ctrl.applicationUser.deadlinesmsNotify"
                                                   ng-disabled="!ctrl.globalSetting.enableSMSNotification"
                                                   ng-change="ctrl.resetNotificationsAppUser('deadlinesmsNotify','deadlineSmspriority', [applicationUserForm.deadlineSmspriority])"
                                                   aria-label="{{lang.deadline_sms}}">
                                            <label>{{lang.deadline_sms}} :
                                                {{ctrl.applicationUser.getTranslatedYesNo('deadlinesmsNotify')}}</label>
                                        </md-switch>
                                        <!-- Deadline SMS Priority -->
                                        <md-input-container flex>
                                            <label for="deadlineSmspriority">{{lang.deadline_sms_priority}}</label>
                                            <md-select multiple ng-required="ctrl.applicationUser.deadlinesmsNotify"
                                                       ng-disabled="!ctrl.globalSetting.enableSMSNotification || !ctrl.applicationUser.deadlinesmsNotify"
                                                       ng-readonly="!ctrl.applicationUser.deadlinesmsNotify"
                                                       name="deadlineSmspriority" id="deadlineSmspriority"
                                                       ng-model="ctrl.applicationUser.deadlineSmspriority">
                                                <md-option ng-value="priorityLevel"
                                                           ng-repeat="priorityLevel in ctrl.priorityLevels track by $index">
                                                    {{priorityLevel.getTranslatedName()}}
                                                </md-option>
                                            </md-select>
                                            <div ng-messages="applicationUserForm.deadlineSmspriority.$error">
                                                <div ng-message="required">{{lang.field_required}}</div>
                                                <div ng-message="number">{{lang.numberonly}}</div>
                                                <div ng-message="maxlength">{{lang.max_length.change({length:5})}}</div>
                                            </div>
                                        </md-input-container>
                                    </div>
                                    <!-- Reminder SMS, Priority and Days -->
                                    <div layout="row">
                                        <!-- Reminder SMS -->
                                        <md-switch flex ng-model="ctrl.applicationUser.reminderSmsnotify"
                                                   ng-disabled="!ctrl.globalSetting.enableSMSNotification"
                                                   ng-change="ctrl.resetNotificationsAppUser('reminderSmsnotify',['reminderSmsPriority', 'reminderSmsdays'], [applicationUserForm.reminderSmsPriority, applicationUserForm.reminderSmsdays])"
                                                   aria-label="{{lang.reminder_sms}}">
                                            <label>{{lang.reminder_sms}} :
                                                {{ctrl.applicationUser.getTranslatedYesNo('reminderSmsnotify')}}</label>
                                        </md-switch>
                                        <!-- Reminder SMS Priority and Days -->
                                        <div layout="row" flex>
                                            <!-- Reminder SMS Priority -->
                                            <md-input-container flex>
                                                <label for="reminderSmsPriority">{{lang.reminder_sms_priority}}</label>
                                                <md-select multiple ng-required="ctrl.applicationUser.reminderSmsnotify"
                                                           ng-disabled="!ctrl.globalSetting.enableSMSNotification || !ctrl.applicationUser.reminderSmsnotify"
                                                           ng-readonly="!ctrl.applicationUser.reminderSmsnotify"
                                                           name="reminderSmsPriority" id="reminderSmsPriority"
                                                           ng-model="ctrl.applicationUser.reminderSmsPriority">
                                                    <!--multiple ng-model-options="{trackBy: '$value.id'}"-->
                                                    <md-option ng-value="priorityLevel"
                                                               ng-repeat="priorityLevel in ctrl.priorityLevels track by $index">
                                                        {{priorityLevel.getTranslatedName()}}
                                                    </md-option>
                                                </md-select>
                                                <div ng-messages="applicationUserForm.reminderSmsPriority.$error">
                                                    <div ng-message="required">{{lang.field_required}}</div>
                                                    <div ng-message="number">{{lang.numberonly}}</div>
                                                    <div ng-message="maxlength">{{lang.max_length.change({length:5})}}
                                                    </div>
                                                </div>
                                            </md-input-container>
                                            <!-- Reminder SMS Days -->
                                            <md-input-container flex>
                                                <label for="reminderSmsdays">{{lang.reminder_sms_days}}</label>
                                                <input ng-required="ctrl.applicationUser.reminderSmsnotify"
                                                       ng-disabled="!ctrl.globalSetting.enableSMSNotification || !ctrl.applicationUser.reminderSmsnotify"
                                                       ng-readonly="!ctrl.applicationUser.reminderSmsnotify"
                                                       name="reminderSmsdays" id="reminderSmsdays"
                                                       ng-model="ctrl.applicationUser.reminderSmsdays" maxlength="5"
                                                       custom-validate-directive="number">
                                                <div ng-messages="applicationUserForm.reminderSmsdays.$error">
                                                    <div ng-message="required">{{lang.field_required}}</div>
                                                    <div ng-message="number">{{lang.numberonly}}</div>
                                                    <div ng-message="maxlength">{{lang.max_length.change({length:5})}}
                                                    </div>
                                                </div>
                                            </md-input-container>
                                        </div>
                                    </div>
                                </fieldset>
                                <!-- Email Notifications -->
                                <fieldset flex>
                                    <legend class="md-accent">
                                        {{lang.email_settings}}
                                    </legend>
                                    <span class="red-text" ng-if="!ctrl.globalSetting.enableEmailNotification">{{lang.setting_disabled_by_admin}}</span>
                                    <div layout="row">
                                        <md-switch flex ng-model="ctrl.applicationUser.subscriptionEmailNotify"
                                                   ng-disabled="!ctrl.globalSetting.enableEmailNotification"
                                                   aria-label="{{lang.subscription_email}}">
                                            <label><b>{{lang.subscription_email}}</b></label>
                                        </md-switch>
                                    </div>

                                    <!-- New Item Email and Priority -->
                                    <div layout="row">
                                        <!-- New Item Email -->
                                        <md-switch flex ng-model="ctrl.applicationUser.newItemEmailNotify"
                                                   ng-disabled="!ctrl.globalSetting.enableEmailNotification"
                                                   ng-change="ctrl.resetNotificationsAppUser('newItemEmailNotify','newItemEmailPriority', [applicationUserForm.newItemEmailPriority])"
                                                   aria-label="{{lang.new_item_email}}">
                                            <label>{{lang.new_item_email}} :
                                                {{ctrl.applicationUser.getTranslatedYesNo('newItemEmailNotify')}}</label>
                                        </md-switch>
                                        <!-- New Item Email Priority -->
                                        <md-input-container flex>
                                            <label for="newItemEmailPriority">{{lang.new_item_email_priority}}</label>
                                            <md-select multiple ng-required="ctrl.applicationUser.newItemEmailNotify"
                                                       ng-disabled="!ctrl.globalSetting.enableEmailNotification || !ctrl.applicationUser.newItemEmailNotify"
                                                       ng-readonly="!ctrl.applicationUser.newItemEmailNotify"
                                                       name="newItemEmailPriority" id="newItemEmailPriority"
                                                       ng-model="ctrl.applicationUser.newItemEmailPriority">
                                                <!--multiple ng-model-options="{trackBy: '$value.id'}"-->
                                                <md-option ng-value="priorityLevel"
                                                           ng-repeat="priorityLevel in ctrl.priorityLevels track by $index">
                                                    {{priorityLevel.getTranslatedName()}}
                                                </md-option>
                                            </md-select>
                                            <div ng-messages="applicationUserForm.newItemEmailPriority.$error">
                                                <div ng-message="required">{{lang.field_required}}</div>
                                                <div ng-message="number">{{lang.numberonly}}</div>
                                                <div ng-message="maxlength">{{lang.max_length.change({length:5})}}</div>
                                            </div>
                                        </md-input-container>
                                    </div>
                                    <!-- Deadline Email and Priority -->
                                    <div layout="row">
                                        <!-- Deadline Email -->
                                        <md-switch flex ng-model="ctrl.applicationUser.deadlineEmailNotify"
                                                   ng-disabled="!ctrl.globalSetting.enableEmailNotification"
                                                   ng-change="ctrl.resetNotificationsAppUser('deadlineEmailNotify','deadlineEmailPriority', [applicationUserForm.deadlineEmailPriority])"
                                                   aria-label="{{lang.deadline_email}}">
                                            <label>{{lang.deadline_email}} :
                                                {{ctrl.applicationUser.getTranslatedYesNo('deadlineEmailNotify')}}</label>
                                        </md-switch>
                                        <!-- Deadline Email Priority -->
                                        <md-input-container flex>
                                            <label for="deadlineEmailPriority">{{lang.deadline_email_priority}}</label>
                                            <md-select multiple ng-required="ctrl.applicationUser.deadlineEmailNotify"
                                                       ng-disabled="!ctrl.globalSetting.enableEmailNotification || !ctrl.applicationUser.deadlineEmailNotify"
                                                       ng-readonly="!ctrl.applicationUser.deadlineEmailNotify"
                                                       name="deadlineEmailPriority" id="deadlineEmailPriority"
                                                       ng-model="ctrl.applicationUser.deadlineEmailPriority">
                                                <md-option ng-value="priorityLevel"
                                                           ng-repeat="priorityLevel in ctrl.priorityLevels track by $index">
                                                    {{priorityLevel.getTranslatedName()}}
                                                </md-option>
                                            </md-select>
                                            <div ng-messages="applicationUserForm.deadlineEmailPriority.$error">
                                                <div ng-message="required">{{lang.field_required}}</div>
                                                <div ng-message="number">{{lang.numberonly}}</div>
                                                <div ng-message="maxlength">{{lang.max_length.change({length:5})}}</div>
                                            </div>
                                        </md-input-container>
                                    </div>
                                    <!-- Reminder Email, Priority and Days -->
                                    <div layout="row">
                                        <!-- Reminder Email -->
                                        <md-switch flex ng-model="ctrl.applicationUser.reminderEmailNotify"
                                                   ng-disabled="!ctrl.globalSetting.enableEmailNotification"
                                                   ng-change="ctrl.resetNotificationsAppUser('reminderEmailNotify',['reminderEmailPriority', 'reminderEmailDays'], [applicationUserForm.reminderEmailPriority, applicationUserForm.reminderEmailDays])"
                                                   aria-label="{{lang.reminder_email}}">
                                            <label>{{lang.reminder_email}} :
                                                {{ctrl.applicationUser.getTranslatedYesNo('reminderEmailNotify')}}</label>
                                        </md-switch>
                                        <!-- Reminder Email Priority and Days-->
                                        <div layout="row" flex>
                                            <!-- Reminder Email Priority -->
                                            <md-input-container flex>
                                                <label for="reminderEmailPriority">{{lang.reminder_email_priority}}</label>
                                                <md-select multiple
                                                           ng-required="ctrl.applicationUser.reminderEmailNotify"
                                                           ng-disabled="!ctrl.globalSetting.enableEmailNotification || !ctrl.applicationUser.reminderEmailNotify"
                                                           ng-readonly="!ctrl.applicationUser.reminderEmailNotify"
                                                           name="reminderEmailPriority" id="reminderEmailPriority"
                                                           ng-model="ctrl.applicationUser.reminderEmailPriority">
                                                    <md-option ng-value="priorityLevel"
                                                               ng-repeat="priorityLevel in ctrl.priorityLevels track by $index">
                                                        {{priorityLevel.getTranslatedName()}}
                                                    </md-option>
                                                </md-select>
                                                <div ng-messages="applicationUserForm.reminderEmailPriority.$error">
                                                    <div ng-message="required">{{lang.field_required}}</div>
                                                    <div ng-message="number">{{lang.numberonly}}</div>
                                                    <div ng-message="maxlength">{{lang.max_length.change({length:5})}}
                                                    </div>
                                                </div>
                                            </md-input-container>
                                            <!-- Reminder Email Days -->
                                            <md-input-container flex>
                                                <label for="reminderEmailDays">{{lang.reminder_email_days}}</label>
                                                <input ng-required="ctrl.applicationUser.reminderEmailNotify"
                                                       ng-disabled="!ctrl.globalSetting.enableEmailNotification || !ctrl.applicationUser.reminderEmailNotify"
                                                       ng-readonly="!ctrl.applicationUser.reminderEmailNotify"
                                                       name="reminderEmailDays" id="reminderEmailDays"
                                                       ng-model="ctrl.applicationUser.reminderEmailDays" maxlength="5"
                                                       custom-validate-directive="number">
                                                <div ng-messages="applicationUserForm.reminderEmailDays.$error">
                                                    <div ng-message="required">{{lang.field_required}}</div>
                                                    <div ng-message="number">{{lang.numberonly}}</div>
                                                    <div ng-message="maxlength">{{lang.max_length.change({length:5})}}
                                                    </div>
                                                </div>
                                            </md-input-container>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                        </md-content>
                    </md-tab>
                    <!-- Organizations Tab -->
                    <md-tab label="{{lang.organizations}}" ng-if="ctrl.editMode"
                            md-on-select="ctrl.setCurrentTab('ot')">
                        <md-content>
                            <div layout="column" class="p20">
                                <div layout="row" flex>
                                    <md-card flex ng-if="ctrl.ouApplicationUsers.length" layout="column"
                                             class="card-overlay">
                                        <md-table-container flex>
                                            <table md-table>
                                                <thead md-head>
                                                <tr md-row>
                                                    <th md-column>{{lang.organization}}</th>
                                                    <th md-column>{{lang.role}}</th>
                                                    <th md-column>{{lang.security_level_view}} {{lang.security_levels}}</th>
                                                    <th md-column>{{lang.security_levels}}</th>
                                                    <th md-column>{{lang.status}}</th>
                                                    <th md-column>{{lang.private}}</th>
                                                    <th md-column>{{lang.actions}}</th>
                                                </tr>
                                                </thead>
                                                <tbody md-body>
                                                <tr md-row
                                                    ng-repeat="ouApplicationUser in ctrl.ouApplicationUsers track by $index">
                                                    <td md-cell>
                                                        <div layout="column">
                                                            <div layout="row" flex><span flex>{{ouApplicationUser.ouid.arName}}</span>
                                                            </div>
                                                            <div layout="row" flex><span flex>{{ouApplicationUser.ouid.enName}}</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td md-cell>
                                                        {{ouApplicationUser.customRoleId.getTranslatedName()}}
                                                    </td>
                                                    <td md-cell>
                                                        {{ouApplicationUser.securityLevelsString}}
                                                    </td>
                                                    <td md-cell>
                                                        {{ouApplicationUser.archiveSecurityLevelsString}}
                                                    </td>
                                                    <td md-cell>
                                                        <md-switch ng-model="ouApplicationUser.status"
                                                                   ng-disabled="ctrl.disableOUApplicationUserActions(ouApplicationUser)"
                                                                   title="{{ouApplicationUser.getTranslatedStatus()}}"
                                                                   aria-label="{{ouApplicationUser.getTranslatedStatus()}}">
                                                        </md-switch>
                                                    </td>
                                                    <td md-cell>
                                                        <md-switch ng-model="ouApplicationUser.isPrivate"
                                                                   title="{{ouApplicationUser.getTranslatedPrivate()}}"
                                                                   aria-label="{{ouApplicationUser.getTranslatedPrivate()}}">
                                                        </md-switch>
                                                    </td>
                                                    <td md-cell>
                                                        <div flex layout="row" layout-align="start center">
                                                            <md-button class="md-icon-button" title="{{lang.save}}"
                                                                       ng-click="ctrl.saveOUApplicationUserFromCtrl(ouApplicationUser, $event)">
                                                                <md-icon md-svg-icon="content-save"></md-icon>
                                                            </md-button>
                                                            <md-menu>
                                                                <md-button aria-label="Open OU permission menu"
                                                                           class="md-icon-button"
                                                                           ng-click="$mdMenu.open()">
                                                                    <md-icon md-svg-icon="dots-vertical"></md-icon>
                                                                </md-button>
                                                                <md-menu-content width="4">
                                                                    <md-menu-item>
                                                                        <md-button
                                                                                ng-click="ctrl.openEditPermissionDialog(ouApplicationUser, $event)">
                                                                            {{lang.grid_action_edit_permission}}
                                                                        </md-button>
                                                                    </md-menu-item>
                                                                    <md-menu-item>
                                                                        <md-button
                                                                                ng-click="ctrl.openWorkflowParticipationDialog(ouApplicationUser, $event)">
                                                                            {{lang.grid_action_edit_workflow_participation}}
                                                                        </md-button>
                                                                    </md-menu-item>
                                                                    <md-menu-item>
                                                                        <md-button
                                                                                ng-click="ctrl.openOutOfOfficeSettingsDialog(ouApplicationUser, $event , $index)">
                                                                            {{lang.grid_action_out_of_office_settings}}
                                                                        </md-button>
                                                                    </md-menu-item>
                                                                    <md-menu-item>
                                                                        <md-button
                                                                                ng-click="ctrl.openFollowupOrganizationDialog(ouApplicationUser, $event , $index)">
                                                                            {{lang.followup_organization}}
                                                                        </md-button>
                                                                    </md-menu-item>
                                                                </md-menu-content>
                                                            </md-menu>
                                                            <!--<div flex layout="row" layout-align="start center">
                                                                <grid-actions-directive actions-direction="vertical"
                                                                                        shortcut-actions="ctrl.shortcutActions"
                                                                                        model="ouApplicationUser">
                                                                </grid-actions-directive>
                                                            </div>-->
                                                        </div>
                                                    </td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </md-table-container>
                                    </md-card>
                                </div>
                            </div>
                        </md-content>
                    </md-tab>
                    <!-- Signature -->
                    <md-tab label="{{lang.signature}}" ng-if="ctrl.editMode"
                            md-on-select="ctrl.setCurrentTab('signature')">
                        <md-content class="md-padding">
                            <div layout="column">
                                <ng-form name="signatureForm">
                                    <div layout="column" flex>
                                        <div layout="row">
                                            <div flex>
                                                <label for="upload-sign-app-user"
                                                       class="md-button md-raised alongside-input">
                                                    <span layout="row" layout-align="start center">
                                                        <md-icon md-svg-icon="upload"></md-icon>
                                                        <span>{{lang.upload_signature}}</span>
                                                    </span>
                                                    <input reset-after-change="true"
                                                           catch-upload-file-directive="ctrl.viewImage"
                                                           class="hide-import-file" type="file"
                                                           id="upload-sign-app-user" name="upload-sign-app-user">
                                                </label>
                                            </div>
                                            <md-input-container flex ng-if="ctrl.enableAdd">
                                                <label for="docSubject">{{lang.subject}}</label>
                                                <input name="docSubject" id="docSubject" minlength="4"
                                                       ng-model="ctrl.signature.docSubject"
                                                       ng-required="true"
                                                       maxlength="80">
                                                <div ng-messages="signatureForm.docSubject.$error">
                                                    <div ng-message="required">{{lang.field_required}}</div>
                                                    <div ng-message="minlength">{{lang.short}}</div>
                                                    <div ng-message="maxlength">
                                                        {{lang.max_length.change({length:80})}}
                                                    </div>
                                                </div>
                                            </md-input-container>
                                            <md-input-container flex ng-if="ctrl.enableAdd">
                                                <label for="documentTitle">{{lang.title}}</label>
                                                <input name="documentTitle" id="documentTitle" minlength="4"
                                                       ng-model="ctrl.signature.documentTitle" required
                                                       maxlength="80">
                                                <div ng-messages="signatureForm.documentTitle.$error">
                                                    <div ng-message="required">{{lang.field_required}}</div>
                                                    <div ng-message="minlength">{{lang.short}}</div>
                                                    <div ng-message="maxlength">
                                                        {{lang.max_length.change({length:80})}}
                                                    </div>
                                                </div>
                                            </md-input-container>
                                        </div>
                                        <div layout="row" ng-if="ctrl.enableAdd">
                                            <div flex>
                                                <img name="fileUrl" id="fileUrl" ng-if="ctrl.fileUrl"
                                                     ng-src="{{ctrl.fileUrl}}"
                                                     class="upload-image" height="85" flex>
                                            </div>
                                            <div layout="row" class="p20">
                                                <md-button class="md-raised" ng-disabled="signatureForm.$invalid"
                                                           ng-click="ctrl.addApplicationUserSignatureFromCtrl()">
                                                    {{lang.add}}
                                                </md-button>
                                                <md-button class="md-raised"
                                                           ng-click="ctrl.closeApplicationUserSignatureFromCtrl()">
                                                    {{lang.close}}
                                                </md-button>
                                            </div>
                                        </div>
                                    </div>
                                </ng-form>


                                <div layout="row" ng-if="ctrl.applicationUser.signature.length">
                                    <md-card md-whiteframe="3" flex layout="row" class="card-overlay">
                                        <md-table-container flex scroll-directive>
                                            <table md-table md-row-select
                                                   ng-model="ctrl.selectedSignature"
                                                   md-progress="ctrl.signatureProgress">
                                                <thead md-head md-order="ctrl.signatureGrid.order"
                                                       md-on-reorder="ctrl.getSortedData">
                                                <tr md-row>
                                                    <th colspan="5" ng-if="ctrl.selectedSignature.length"
                                                        md-column>
                                                        <div layout="row" layout-align="start center">
                                                            <span>{{ctrl.selectedSignature.length}} {{lang.items_selected}} </span>
                                                            <span flex></span>
                                                            <!--<table-status-directive
                                                                    when-close="ctrl.changeStatusBulkDocumentTemplates"></table-status-directive>-->
                                                            <!--<md-button class="md-icon-button"
                                                                       ng-click="ctrl.removeBulkSignatures($event)">
                                                                <md-icon md-svg-icon="delete"></md-icon>
                                                            </md-button>-->
                                                        </div>
                                                    </th>
                                                    <th ng-if="!ctrl.selectedSignature.length" md-column
                                                        md-order-by="docSubject">
                                                        <span>{{lang.subject}}</span>
                                                    </th>
                                                    <th ng-if="!ctrl.selectedSignature.length" md-column
                                                        md-order-by="documentTitle">
                                                        <span>{{lang.title}}</span>
                                                    </th>
                                                    <!--<th ng-if="!ctrl.selectedSignature.length" md-column
                                                        md-order-by="docType">
                                                        <span>{{lang.label_document_type}}</span>
                                                    </th>
                                                    <th ng-if="!ctrl.selectedSignature.length" md-column
                                                        md-order-by="templateType">
                                                        <span>{{lang.template_type}}</span>
                                                    </th>-->
                                                    <th ng-if="!ctrl.selectedSignature.length" md-column>
                                                        <span>{{lang.actions}}</span>
                                                    </th>
                                                </tr>
                                                </thead>
                                                <tbody md-body>
                                                <tr md-row
                                                    ng-repeat="signature in ctrl.applicationUser.signature | filter:ctrl.searchModel | limitTo: ctrl.signatureGrid.limit: ((ctrl.signatureGrid.page - 1) * ctrl.signatureGrid.limit) track by $index">
                                                    <td md-cell>{{signature.docSubject}}</td>
                                                    <td md-cell>{{signature.documentTitle}}</td>
                                                    <!--<td md-cell>{{documentTemplate.docType}}</td>
                                                    <td md-cell>{{documentTemplate.templateType}}</td>-->
                                                    <td md-cell>
                                                        <div flex layout="row" layout-align="start center">
                                                            <md-button class="md-icon-button" title="{{lang.edit}}"
                                                                       ng-click="ctrl.editSignature(signature, $event)">
                                                                <md-icon md-svg-icon="pencil"></md-icon>
                                                            </md-button>
                                                            <md-button class="md-icon-button" title="{{lang.delete}}"
                                                                       ng-click="ctrl.removeSignature(signature, $event)">
                                                                <md-icon md-svg-icon="delete"></md-icon>
                                                            </md-button>
                                                        </div>
                                                    </td>
                                                </tr>
                                                </tbody>
                                            </table>
                                            <md-table-pagination
                                                    md-label="{page: '{{lang.page}}', rowsPerPage: '{{lang.rows_per_page}}', of: '{{lang.count_of}}'}"
                                                    md-limit-options="ctrl.signatureGrid.limitOptions"
                                                    md-limit="ctrl.signatureGrid.limit"
                                                    md-page="ctrl.signatureGrid.page"
                                                    md-total="{{ctrl.applicationUser.signature.length}}" md-page-select>
                                            </md-table-pagination>
                                        </md-table-container>
                                    </md-card>
                                </div>

                            </div>
                        </md-content>
                    </md-tab>
                    <!-- Classification View Permission Tab -->
                    <md-tab label="{{lang.classification_view_permission}}" ng-if="ctrl.editMode"
                            md-on-select="ctrl.setCurrentTab('cvp')">
                        <md-content class="md-padding">
                            <div layout="column">
                                <div layout="row" flex>
                                    <!-- Classifications Dropdown -->
                                    <md-input-container flex ng-if="!ctrl.classificationViewPermission.id">
                                        <label for="classification">{{lang.classification}}</label>
                                        <md-select id="classification" name="classification"
                                                   ng-change="ctrl.resetSecurityLevels()"
                                                   ng-disabled="ctrl.classificationViewPermission.id"
                                                   ng-model="ctrl.classificationViewPermission.classificationId">
                                            <md-option ng-value="classification"
                                                       ng-if="ctrl.excludeClassificationsIfExists(classification)"
                                                       ng-repeat="classification in ctrl.classifications track by $index">
                                                {{classification.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>

                                    <!-- Classifications Textbox-->
                                    <md-input-container flex ng-if="ctrl.classificationViewPermission.id">
                                        <label for="classification">{{lang.classification}}</label>
                                        <input ng-value="ctrl.classificationViewPermission.classificationId.getTranslatedName()"
                                               title="{{ctrl.classificationViewPermission.classificationId.getTranslatedName()}}"
                                               name="classificationText" id="classificationText"
                                               ng-disabled="true" ng-readonly="true">
                                    </md-input-container>

                                    <!-- Security Levels -->
                                    <md-input-container flex>
                                        <label for="securityLevel">{{lang.security_levels}}</label>
                                        <md-select id="securityLevel" name="securityLevel" multiple
                                                   ng-model="ctrl.classificationViewPermission.securityLevels">
                                            <md-option ng-value="securityLevel"
                                                       ng-repeat="securityLevel in ctrl.classificationViewPermission.classificationId.securityLevels track by $index">
                                                {{securityLevel.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="applicationUserForm.securityLevel.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <!-- Buttons -->
                                    <div class="p20">
                                        <md-button class="md-raised" ng-if="!ctrl.classificationViewPermission.id"
                                                   ng-disabled="!ctrl.classificationViewPermission.classificationId
                                               || !ctrl.classificationViewPermission.securityLevels.length"
                                                   ng-click="ctrl.addClassificationViewPermissionFromCtrl()">
                                            {{lang.add}}
                                        </md-button>
                                        <!--<md-button class="md-raised" ng-if="ctrl.classificationViewPermission.id"
                                                   ng-disabled="!ctrl.classificationViewPermission.classificationId
                                               || !ctrl.classificationViewPermission.securityLevels.length"
                                                   ng-click="ctrl.updateClassificationViewPermissionFromCtrl()">
                                            {{lang.save}}
                                        </md-button>
                                        <md-button class="md-raised" ng-if="ctrl.classificationViewPermission.id"
                                                   ng-click="ctrl.cancelClassificationViewPermissionFromCtrl()">
                                            {{lang.cancel}}
                                        </md-button>-->
                                    </div>
                                </div>
                                <div layout="row" flex>
                                    <md-card flex ng-if="ctrl.classificationViewPermissions.length" layout="column"
                                             class="card-overlay">
                                        <md-table-container flex>
                                            <table md-table>
                                                <thead md-head>
                                                <tr md-row>
                                                    <th md-column>{{lang.arabic_name}}</th>
                                                    <th md-column>{{lang.english_name}}</th>
                                                    <th md-column>{{lang.security_levels}}</th>
                                                    <th md-column>{{lang.actions}}</th>
                                                </tr>
                                                </thead>
                                                <tbody md-body>
                                                <tr md-row
                                                    ng-repeat="classificationViewPermission in ctrl.classificationViewPermissions track by $index">
                                                    <td md-cell>
                                                        {{classificationViewPermission.classificationId.arName}}
                                                    </td>
                                                    <td md-cell>
                                                        {{classificationViewPermission.classificationId.enName}}
                                                    </td>
                                                    <td md-cell>
                                                        {{classificationViewPermission.getSecurityLevelsText()}}
                                                    </td>
                                                    <td md-cell>
                                                        <div flex layout="row" layout-align="start center">
                                                            <md-button class="md-icon-button" title="{{lang.delete}}"
                                                                       ng-click="ctrl.removeClassificationViewPermission(classificationViewPermission, $event)">
                                                                <md-icon md-svg-icon="delete"></md-icon>
                                                            </md-button>
                                                            <!--<md-button class="md-icon-button" title="{{lang.edit}}"
                                                                       ng-click="ctrl.editClassificationViewPermission(classificationViewPermission, $event)">
                                                                <md-icon md-svg-icon="pencil"></md-icon>
                                                            </md-button>-->
                                                        </div>
                                                    </td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </md-table-container>
                                    </md-card>
                                </div>
                            </div>
                        </md-content>
                    </md-tab>
                    <!-- OU View Permission Tab -->
                    <md-tab label="{{lang.ou_view_permission}}" ng-if="ctrl.editMode"
                            md-on-select="ctrl.setCurrentTab('ouvp')">
                        <md-content class="md-padding">
                            <div layout="column">
                                <div layout="row">
                                    <!-- Organizations Dropdown-->
                                    <md-input-container flex>
                                        <label for="ouid">{{lang.organization_unit}}</label>
                                        <md-select id="ouid" name="ouid"
                                                   ng-model-options="{trackBy : '$value.id'}"
                                                   ng-model="ctrl.ouViewPermission.ouId"
                                                   md-on-close="ctrl.clearSearchText('inlineUserOU')"
                                                   data-md-container-class="select-header-container">
                                            <md-select-header class="select-header">
                                                <input ng-model="ctrl.inlineOuSearchText"
                                                       ng-keydown="ctrl.preventSearchKeyDown($event)"
                                                       placeholder="{{lang.search}}"
                                                       class="select-header-input">
                                            </md-select-header>
                                            <md-option ng-value="organization"
                                                       ng-if="ctrl.excludeOuViewPermissionIfExists(organization)"
                                                       ng-repeat="organization in ctrl.organizationsCopy | translatedNameFilter: ctrl.inlineOuSearchText : 'getNameByLanguageRegOUSection'"
                                                       ng-disabled="!organization.status"
                                                       tooltip="{{(!organization.status)? lang.inactive_organization : '' }}">
                                                <span
                                                        md-highlight-text="ctrl.inlineUserOUSearchText"
                                                        md-highlight-flags="i">{{organization.getTranslatedNameRegOUSection()}}</span>
                                            </md-option>
                                        </md-select>
                                    </md-input-container>

                                    <!-- Security Levels -->
                                    <md-input-container flex>
                                        <label for="securityLevel">{{lang.security_levels}}</label>
                                        <md-select id="ouSecurityLevel" name="ouSecurityLevel" multiple
                                                   ng-model-options="{trackBy:'$value.lookupKey'}"
                                                   ng-model="ctrl.ouViewPermission.securityLevels">
                                            <md-option ng-value="securityLevel"
                                                       ng-repeat="securityLevel in ctrl.securityLevels">
                                                {{securityLevel.getTranslatedName()}}
                                            </md-option>
                                        </md-select>
                                        <div ng-messages="applicationUserForm.securityLevel.$error">
                                            <div ng-message="required">{{lang.field_required}}</div>
                                        </div>
                                    </md-input-container>
                                    <!-- Buttons -->
                                    <div class="p20">
                                        <md-button class="md-raised" ng-disabled="!ctrl.ouViewPermission.ouId
                                               || !ctrl.ouViewPermission.securityLevels.length"
                                                   ng-click="ctrl.addOuViewPermissionFromCtrl()">
                                            {{lang.add}}
                                        </md-button>
                                    </div>
                                </div>
                                <div layout="row">
                                    <md-card layout="column"
                                             flex class="card-overlay">
                                        <md-table-container>
                                            <table md-table md-row-select multiple
                                                   ng-model="ctrl.selectedOUViewPermissions"
                                                   md-progress="ctrl.ouViewPermissionsGrid.progress">
                                                <thead md-head md-order="ctrl.ouViewPermissionsGrid.order"
                                                       md-on-reorder="ctrl.getSortedDataOUViewPermissions">
                                                <tr md-row>
                                                    <th colspan="4" class="table-selector-header"
                                                        ng-if="ctrl.selectedOUViewPermissions.length" md-column>
                                                        <div layout="row" layout-align="start center">
                                                            <span>{{ctrl.selectedOUViewPermissions.length}} {{lang.items_selected}} </span>
                                                            <span flex></span>
                                                            <md-button class="md-icon-button"
                                                                       ng-click="ctrl.removeBulkOUViewPermissions($event)">
                                                                <md-icon md-svg-icon="delete"></md-icon>
                                                            </md-button>
                                                        </div>
                                                    </th>
                                                    <th md-column ng-if="!ctrl.selectedOUViewPermissions.length"
                                                        md-order-by="ouInfo.arName">{{lang.arabic_name}}
                                                    </th>
                                                    <th md-column ng-if="!ctrl.selectedOUViewPermissions.length"
                                                        md-order-by="ouInfo.enName">{{lang.english_name}}
                                                    </th>
                                                    <th md-column ng-if="!ctrl.selectedOUViewPermissions.length"
                                                        md-order-by="">{{lang.security_levels}}
                                                    </th>
                                                    <th md-column ng-if="!ctrl.selectedOUViewPermissions.length">
                                                        {{lang.actions}}
                                                    </th>
                                                </tr>
                                                </thead>
                                                <tbody md-body>
                                                <tr md-select="ouViewPermission" md-row
                                                    ng-repeat="ouViewPermission in ctrl.ouViewPermissions | filter:ctrl.searchModel | limitTo: ctrl.ouViewPermissionsGrid.limit: ((ctrl.ouViewPermissionsGrid.page - 1) * ctrl.ouViewPermissionsGrid.limit) track by $index">
                                                    <td md-cell>
                                                        {{ouViewPermission.ouInfo.arName}}
                                                    </td>
                                                    <td md-cell>
                                                        {{ouViewPermission.ouInfo.enName}}
                                                    </td>
                                                    <td md-cell>
                                                        {{ouViewPermission.getSecurityLevelsText()}}
                                                    </td>
                                                    <td md-cell>
                                                        <div flex layout="row" layout-align="start center">
                                                            <md-button class="md-icon-button" title="{{lang.delete}}"
                                                                       ng-click="ctrl.removeOUViewPermission(ouViewPermission, $event)">
                                                                <md-icon md-svg-icon="delete"></md-icon>
                                                            </md-button>
                                                        </div>
                                                    </td>
                                                </tr>
                                                </tbody>
                                            </table>
                                            <md-table-pagination
                                                    md-label="{page: '{{lang.page}}', rowsPerPage: '{{lang.rows_per_page}}', of: '{{lang.count_of}}'}"
                                                    md-limit-options="ctrl.ouViewPermissionsGrid.limitOptions"
                                                    md-limit="ctrl.ouViewPermissionsGrid.limit"
                                                    md-page="ctrl.ouViewPermissionsGrid.page"
                                                    md-total="{{(ctrl.ouViewPermissions | filter:ctrl.searchModel).length}}"
                                                    md-page-select>
                                            </md-table-pagination>
                                        </md-table-container>
                                    </md-card>
                                </div>
                            </div>
                    </md-tab>
                </md-tabs>
            </form>
        </div>
    </md-dialog-content>
    <md-dialog-actions class="cms-dialog-actions">
        <md-button class="md-raised" ng-disabled="applicationUserForm.$invalid"
                   ng-if="!ctrl.editMode"
                   ng-click="ctrl.addApplicationUserAndOUFromCtrl()">{{lang.add}}
        </md-button>
        <md-button class="md-raised" ng-disabled="applicationUserForm.$invalid"
                   ng-if="ctrl.editMode && ctrl.selectedTab!=='cvp' && ctrl.selectedTab!=='ot' && ctrl.selectedTab !== 'signature'"
                   ng-click="ctrl.editApplicationUserAndOUFromCtrl()">{{lang.save}}
        </md-button>
        <span flex></span>
        <md-button class="md-raised" ng-click="ctrl.closeApplicationUserPopupFromCtrl()">
            {{lang.close}}
        </md-button>
    </md-dialog-actions>
</md-dialog>
