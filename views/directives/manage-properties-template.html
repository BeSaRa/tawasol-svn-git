<form name="outgoing_properties">
    <fieldset class="field-set-hidden">
        <div layout="column">
            <div layout="row">
                <!-- Correspondence registry (If show registry unit)-->
                <md-input-container ng-if="ctrl.showRegistryUnit() && ctrl.checkStatus('registryOU')" flex>
                    <label for="registryOU">{{lang.corr_registry}}</label>
                    <md-select name="registryOU"
                               id="registryOU"
                               ng-change="ctrl.onRegistryChange(ctrl.document.registryOU)"
                               ng-disabled="!!ctrl.disableProperties || ctrl.checkOrganizationDisabled()"
                               ng-readonly="!ctrl.employee.hasPermissionTo(ctrl.document.docClassName + '_CENTRAL_ARCHIVING')"
                               ng-model="ctrl.document.registryOU"
                               ng-required="ctrl.checkMandatory('registryOU')"
                               md-on-close="ctrl.clearSearchText('registryOU')"
                               data-md-container-class="select-header-container">
                        <md-select-header class="select-header">
                            <input ng-model="ctrl.registryOUSearchText"
                                   ng-keydown="ctrl.handleSearchKeyDown($event)"
                                   placeholder="{{lang.search}}"
                                   class="select-header-input">
                        </md-select-header>
                        <md-option ng-value="organization.id"
                                   ng-repeat="organization in ctrl.registryOrganizations | translatedNameFilter: ctrl.registryOUSearchText">
                            <span
                                    md-highlight-text="ctrl.registryOUSearchText"
                                    md-highlight-flags="i">{{organization.getTranslatedName()}}</span>
                        </md-option>
                    </md-select>
                    <div ng-messages="outgoing_properties.ou.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
                <!-- OU (If show registry unit) -->
                <md-input-container ng-if="ctrl.showRegistryUnit() && ctrl.checkStatus('ou')" flex>
                    <label for="ou">{{lang.organization_unit}}</label>
                    <md-select name="ou"
                               id="ou"
                               ng-disabled="!!ctrl.disableProperties || ctrl.checkOrganizationDisabled()"
                               ng-readonly="!ctrl.employee.hasPermissionTo(ctrl.document.docClassName + '_CENTRAL_ARCHIVING')"
                               ng-model="ctrl.document.ou"
                               ng-required="ctrl.checkMandatory('ou')"
                               md-on-close="ctrl.clearSearchText('registrySection')"
                               data-md-container-class="select-header-container">
                        <md-select-header class="select-header">
                            <input ng-model="ctrl.registrySectionSearchText"
                                   ng-keydown="ctrl.handleSearchKeyDown($event)"
                                   placeholder="{{lang.search}}"
                                   class="select-header-input">
                        </md-select-header>
                        <md-option ng-value="organization.id"
                                   ng-repeat="organization in ctrl.subOrganizations | translatedNameFilter: ctrl.registrySectionSearchText">
                            <span
                                    md-highlight-text="ctrl.registrySectionSearchText"
                                    md-highlight-flags="i">{{organization.getTranslatedName()}}</span>
                        </md-option>
                    </md-select>
                    <div ng-messages="outgoing_properties.ou.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
                <!-- OU (If not show registry unit) -->
                <md-input-container ng-if="!ctrl.showRegistryUnit() && ctrl.checkStatus('ou')" flex>
                    <label for="ou">{{lang.organization_unit}}</label>
                    <md-select name="ou"
                               id="ou"
                               ng-disabled="!!ctrl.disableProperties || ctrl.checkOrganizationDisabled()"
                               ng-readonly="!ctrl.employee.hasPermissionTo(ctrl.document.docClassName + '_CENTRAL_ARCHIVING')"
                               ng-model="ctrl.document.ou"
                               ng-required="ctrl.checkMandatory('ou')"
                               md-on-close="ctrl.clearSearchText('ou')"
                               data-md-container-class="select-header-container">
                        <md-select-header class="select-header">
                            <input ng-model="ctrl.ouSearchText"
                                   ng-keydown="ctrl.handleSearchKeyDown($event)"
                                   placeholder="{{lang.search}}"
                                   class="select-header-input">
                        </md-select-header>
                        <md-option ng-value="organization.id"
                                   ng-repeat="organization in ctrl.organizations | translatedNameFilter: ctrl.ouSearchText">
                            <span
                                    md-highlight-text="ctrl.ouSearchText"
                                    md-highlight-flags="i">{{organization.getTranslatedName()}}</span>
                        </md-option>
                    </md-select>
                    <div ng-messages="outgoing_properties.ou.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
                <!-- Security Level (Disabled Input) -->
                <md-input-container ng-if="ctrl.checkStatus('securityLevel') && ctrl.isShowSecurityLevelInput()" flex>
                    <label for="securityLevelInput">{{lang.security_level}}</label>
                    <input id="securityLevelInput" name="securityLevel"
                           ng-disabled="true"
                           ng-readonly="true"
                           ng-value="ctrl.sourceModel.securityLevel.getTranslatedName()">
                </md-input-container>
                <!-- Security Level (Select) -->
                <md-input-container ng-if="ctrl.checkStatus('securityLevel') && ctrl.isShowSecurityLevelDDL()" flex>
                    <label for="securityLevel">{{lang.security_level}}</label>
                    <md-select name="securityLevel"
                               id="securityLevel"
                               ng-change="ctrl.onSecurityLevelChange()"
                               ng-disabled="!!ctrl.disableProperties"
                               ng-model="ctrl.document.securityLevel"
                               ng-model-options="{trackBy: '$value.id'}"
                               ng-required="ctrl.checkMandatory('securityLevel')">
                        <md-option ng-value="level"
                                   ng-repeat="level in ctrl.securityLevels"
                                   ng-disabled="ctrl.isPrivateSecurityLevel(level) && ctrl.document.hasVsId()"
                                   ng-readonly="ctrl.isPrivateSecurityLevel(level) && ctrl.document.hasVsId()">
                            {{level.getTranslatedName()}}
                        </md-option>
                    </md-select>
                    <div ng-messages="outgoing_properties.securityLevel.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
                <!-- Security Level Checkbox -->
                <md-input-container ng-if="ctrl.checkStatus('securityLevel') && ctrl.isShowSecurityLevelCheckbox()">
                    <md-checkbox ng-model="ctrl.isSecurityLevelEnabled"
                                 aria-label="{{ ctrl.getTranslatedEnableDisableSecurityLevel() }}"
                                 tooltip="{{ ctrl.getTranslatedEnableDisableSecurityLevel() }}">
                    </md-checkbox>
                </md-input-container>
                <!-- Document Number -->
                <md-input-container flex
                                    ng-if='ctrl.document.docClassName.toLowerCase() === "incoming" && ctrl.checkStatus("refDocNumber")'>
                    <label for="refDocNumber">{{lang.document_number}}</label>
                    <input name="refDocNumber" id="refDocNumber"
                           ng-required="ctrl.checkMandatory('refDocNumber')"
                           ng-disabled="!!ctrl.disableProperties || ctrl.checkDepartmentalReceived() || ctrl.checkG2gReceived()"
                           ng-model="ctrl.document.refDocNumber">
                    <!--custom-validate-directive="number"-->
                    <div ng-messages="outgoing_properties.refDocNumber.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                        <!--<div ng-message="number">{{lang.numberonly}}</div>-->
                    </div>
                </md-input-container>
                <!-- Type (Personal/Departmental) -->
                <md-input-container flex
                                    ng-if='ctrl.document.docClassName.toLowerCase() === "internal" && ctrl.checkStatus("internalDocType")'>
                    <label for="type">{{lang.type}}</label>
                    <md-select name="type" id="type"
                               ng-disabled="!!ctrl.disableProperties"
                               ng-model="ctrl.document.internalDocType"
                               ng-required="ctrl.checkMandatory('internalDocType')"
                               required>
                        <md-option ng-value="type.value"
                                   ng-repeat="type in ctrl.typeOptions track by $index">
                            {{lang[type.key]}}
                        </md-option>
                    </md-select>
                    <div ng-messages="outgoing_properties.type.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
                <!-- Date -->
                <md-input-container ng-if="ctrl.checkStatus('docDate')">
                    <label for="docDate">{{ctrl.document.hasDocumentClass('incoming') ? lang.incoming_date :
                        lang.document_date }}</label>
                    <md-datepicker name="docDate" id="docDate"
                                   ng-disabled="!!ctrl.disableProperties"
                                   ng-model="ctrl.document.docDate"
                                   ng-change="ctrl.checkIncomingDateValid()"
                                   md-max-date="ctrl.maxCreateDate"
                                   ng-required="ctrl.checkMandatory('docDate')"
                                   md-open-on-focus></md-datepicker>
                    <!--md-placeholder="{{lang.document_date}}"-->
                    <div ng-messages="outgoing_properties.docDate.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
                <!-- RefDocDate -->
                <md-input-container
                        ng-if="ctrl.checkStatus('refDocDate') && ctrl.document.hasDocumentClass('incoming')">
                    <label for="refDocDate">{{ctrl.document.hasDocumentClass('incoming') ? lang.document_date :
                        lang.incoming_date }}</label>
                    <md-datepicker name="refDocDate" id="refDocDate"
                                   ng-disabled="!!ctrl.disableProperties"
                                   ng-model="ctrl.document.refDocDate"
                                   md-max-date="ctrl.document.docDate"
                                   ng-required="ctrl.checkMandatory('refDocDate')"
                                   md-open-on-focus></md-datepicker>
                    <!--md-placeholder="{{lang.document_date}}"-->
                    <div ng-messages="outgoing_properties.refDocDate.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
            </div>
            <div layout="row" ng-if="ctrl.checkStatus('docSubject')">
                <!-- Subject -->
                <md-input-container flex>
                    <label for="docSubject">{{lang.document_subject}}</label>
                    <!--custom-validate-directive="AEN" -->
                    <textarea name="docSubject"
                              id="docSubject"
                              maxlength="1000"
                              md-maxlength="1000"
                              ng-disabled="!!ctrl.disableProperties"
                              ng-model="ctrl.document.docSubject"
                              ng-required="ctrl.checkMandatory('docSubject')"></textarea>
                    <div ng-messages="outgoing_properties.docSubject.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                        <div ng-message="AEN">{{lang.arabic_english_number}}</div>
                    </div>
                </md-input-container>
            </div>
            <div layout="row">
                <!-- Main Classification -->
                <md-input-container flex ng-if="ctrl.checkStatus('mainClassification')">
                    <label for="mainClassification">{{lang.outgoing_main_classification}}</label>
                    <md-select name="mainClassification"
                               id="mainClassification"
                               ng-disabled="!!ctrl.disableProperties"
                               ng-model="ctrl.document.mainClassification"
                               ng-model-options="{trackBy: '$value.id'}"
                               ng-required="ctrl.checkMandatory('mainClassification')"
                               ng-change="ctrl.onChangeMainClassification($event)"
                               md-on-close="ctrl.clearSearchText('mainClassification')"
                               data-md-container-class="select-header-container">
                        <md-select-header class="select-header" layout="column">
                            <div layout="row" flex class="size-100">
                                <input ng-model="ctrl.mainClassificationSearchText"
                                       ng-keydown="ctrl.handleSearchKeyDown($event, 'mainClassification')"
                                       placeholder="{{lang.search}}"
                                       class="select-header-input">
                                <md-button ng-if="ctrl.mainClassificationSearchText"
                                           ng-click="ctrl.loadMainClassificationRecords($event)"
                                           class="select-header-icon md-icon-button"
                                           tooltip="{{lang.load_more_records}}">
                                    <md-icon md-svg-icon="magnify-plus"></md-icon>
                                </md-button>
                            </div>
                            <div class="help-text-div" ng-if="ctrl.mainClassificationSearchText">
                                {{lang.press_enter_to_load_more_records}}
                            </div>
                        </md-select-header>
                        <md-option ng-value="classification.classification"
                                   ng-repeat="classification in ctrl.classifications | translatedNameFilter: ctrl.mainClassificationSearchText:null:'classification'">
                            <span
                                    md-highlight-text="ctrl.mainClassificationSearchText"
                                    md-highlight-flags="i">{{classification.classification.getTranslatedName()}}</span>
                        </md-option>
                    </md-select>
                    <div ng-messages="outgoing_properties.mainClassification.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
                <!-- Sub Classification -->
                <md-input-container flex ng-if="ctrl.checkStatus('subClassification')">
                    <label for="subClassification">{{lang.outgoing_sub_classification}}</label>
                    <md-select
                            ng-disabled="!!ctrl.disableProperties || !ctrl.document.mainClassification"
                            name="subClassification"
                            id="subClassification"
                            ng-model-options="{trackBy: '$value.id'}"
                            ng-model="ctrl.document.subClassification"
                            ng-required="ctrl.checkMandatory('subClassification')"
                            md-on-close="ctrl.clearSearchText('subClassification')"
                            data-md-container-class="select-header-container">
                        <md-select-header class="select-header" layout="column">
                            <div layout="row" flex class="size-100">
                                <input ng-model="ctrl.subClassificationSearchText"
                                       ng-keydown="ctrl.handleSearchKeyDown($event, 'subClassification')"
                                       placeholder="{{lang.search}}"
                                       class="select-header-input">
                                <md-button ng-if="ctrl.subClassificationSearchText"
                                           ng-click="ctrl.loadSubClassificationRecords($event)"
                                           class="select-header-icon md-icon-button"
                                           tooltip="{{lang.load_more_records}}">
                                    <md-icon md-svg-icon="magnify-plus"></md-icon>
                                </md-button>
                            </div>
                            <div class="help-text-div" ng-if="ctrl.subClassificationSearchText">
                                {{lang.press_enter_to_load_more_records}}
                            </div>
                        </md-select-header>
                        <md-option ng-value="classification"
                                   ng-repeat="classification in ctrl.document.mainClassification.children | translatedNameFilter: ctrl.subClassificationSearchText">
                            <span
                                    md-highlight-text="ctrl.subClassificationSearchText"
                                    md-highlight-flags="i">{{classification.getTranslatedName()}}</span>
                        </md-option>
                    </md-select>
                    <div ng-messages="outgoing_properties.subClassification.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
            </div>
            <div layout="row">
                <!-- Priority Level -->
                <md-input-container ng-if="ctrl.checkStatus('priorityLevel')" flex>
                    <label for="priorityLevel">{{lang.outgoing_priority_level}}</label>
                    <md-select name="priorityLevel"
                               id="priorityLevel"
                               ng-disabled="!!ctrl.disableProperties"
                               ng-model="ctrl.document.priorityLevel"
                               ng-model-options="{trackBy: '$value.id'}"
                               ng-required="ctrl.checkMandatory('priorityLevel')">
                        <md-option ng-value="priorityLevel"
                                   ng-repeat="priorityLevel in ctrl.priorityLevels">
                            {{priorityLevel.getTranslatedName()}}
                        </md-option>
                    </md-select>
                    <div ng-messages="outgoing_properties.priorityLevel.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
                <!-- Document Type -->
                <md-input-container ng-if="ctrl.checkStatus('docType')" flex>
                    <label for="docType">{{lang.outgoing_document_type}}</label>
                    <md-select name="docType"
                               id="docType"
                               ng-disabled="!!ctrl.disableProperties"
                               ng-model="ctrl.document.docType"
                               ng-model-options="{trackBy: '$value.id'}"
                               ng-required="ctrl.checkMandatory('docType')">
                        <md-option ng-value="documentType"
                                   ng-repeat="documentType in ctrl.documentTypes">
                            {{documentType.getTranslatedName()}}
                        </md-option>
                    </md-select>
                    <div ng-messages="outgoing_properties.docType.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
                <!-- Add Document Type -->
                <md-input-container ng-if="ctrl.checkStatus('docType') && !ctrl.disableProperties">
                    <md-button class="md-icon-button"
                               ng-disabled="!!ctrl.disableProperties"
                               ng-click="ctrl.shortcut.addNewDocumentType($event)">
                        <md-icon md-svg-icon="plus"></md-icon>
                    </md-button>
                </md-input-container>
            </div>

            <div layout="row">
                <!-- File -->
                <md-input-container ng-if="ctrl.checkStatus('fileId')" flex>
                    <label for="fileId">{{lang.outgoing_file}}</label>
                    <md-select name="fileId"
                               id="fileId"
                               ng-change="ctrl.onFileChange(ctrl.document.fileId)"
                               ng-model="ctrl.document.fileId"
                               ng-disabled="!!ctrl.disableProperties"
                               ng-model-options="{trackBy: '$value.id'}"
                               ng-required="ctrl.checkMandatory('fileId')"
                               md-on-close="ctrl.clearSearchText('documentFile')"
                               data-md-container-class="select-header-container">
                        <md-select-header class="select-header" layout="column">
                            <div layout="row" flex class="size-100">
                                <input ng-model="ctrl.documentFileSearchText"
                                       ng-keydown="ctrl.handleSearchKeyDown($event, 'documentFile')"
                                       placeholder="{{lang.search}}"
                                       class="select-header-input">
                                <md-button ng-if="ctrl.documentFileSearchText"
                                           ng-click="ctrl.loadDocumentFilesRecords($event)"
                                           class="select-header-icon md-icon-button"
                                           tooltip="{{lang.load_more_records}}">
                                    <md-icon md-svg-icon="magnify-plus"></md-icon>
                                </md-button>
                            </div>
                            <div class="help-text-div" ng-if="ctrl.documentFileSearchText">
                                {{lang.press_enter_to_load_more_records}}
                            </div>
                        </md-select-header>
                        <md-option ng-value="file.file"
                                   ng-repeat="file in ctrl.documentFiles | translatedNameFilter: ctrl.documentFileSearchText:null:'file'">
                            <span
                                    md-highlight-text="ctrl.documentFileSearchText"
                                    md-highlight-flags="i">{{file.file.getTranslatedName()}}</span>
                        </md-option>
                    </md-select>
                    <div ng-messages="outgoing_properties.fileId.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
                <!-- Add File -->
                <md-input-container ng-if="ctrl.checkStatus('fileId') && !ctrl.disableProperties">
                    <md-button tooltip="{{lang.outgoing_add_new_document_file}}"
                               class="md-icon-button"

                               ng-disabled="!!ctrl.disableProperties"
                               ng-click="ctrl.shortcut.addNewDocumentFile($event)">
                        <md-icon md-svg-icon="plus"></md-icon>
                    </md-button>
                </md-input-container>
                <!-- File Code -->
                <md-input-container ng-if="ctrl.checkStatus('fileCode')" flex>
                    <label for="fileCode">{{lang.outgoing_file_code}}</label>
                    <input name="fileCode"
                           id="fileCode"
                           ng-disabled="!!ctrl.disableProperties"
                           ng-enter="ctrl.onFileCodeChanged()"
                           ng-model="ctrl.document.fileCode"
                           ng-required="ctrl.checkMandatory('fileCode')">
                    <div ng-messages="outgoing_properties.fileCode.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                    </div>
                </md-input-container>
                <!-- File Serial -->
                <md-input-container flex ng-if="ctrl.checkStatus('fileSerial')">
                    <label for="fileSerial">{{lang.outgoing_file_serial}}</label>
                    <input name="fileSerial"
                           id="fileSerial"
                           ng-disabled="!!ctrl.disableProperties"
                           ng-model="ctrl.document.fileSerial"
                           ng-required="ctrl.checkMandatory('fileSerial')">
                    <div ng-messages="outgoing_properties.fileSerial.$error">
                        <div ng-message="required">{{lang.field_required}}</div>
                        <div ng-message="number">{{lang.numberonly}}</div>
                    </div>
                </md-input-container>
            </div>
            <div ng-if="ctrl.checkStatus('docNotes')" layout="row">
                <!-- Notes -->
                <md-input-container flex>
                    <label for="docNotes">{{lang.properties_notes}}</label>
                    <textarea ng-required="ctrl.checkMandatory('docNotes')" name="docNotes" id="docNotes"
                              ng-model="ctrl.document.docNotes" rows="5"
                              ng-disabled="!!ctrl.disableProperties"></textarea>
                </md-input-container>
            </div>
        </div>
    </fieldset>
</form>
